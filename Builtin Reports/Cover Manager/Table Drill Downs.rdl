<?xml version="1.0" encoding="utf-8"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner"><AutoRefresh>0</AutoRefresh><DataSources><DataSource Name="iSAMS"><DataSourceReference>iSAMS</DataSourceReference><rd:SecurityType>None</rd:SecurityType><rd:DataSourceID>3e0e201a-c88c-4919-a240-b67a5b067986</rd:DataSourceID></DataSource></DataSources><DataSets><DataSet Name="CoverAbsences"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></QueryParameter><QueryParameter Name="@txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></QueryParameter></QueryParameters><CommandText>WIth
CoverSessions AS 
(SELECT 

Count(TblCoverManagerCover.TblCoverManagerCoverID) AS intSessionCount , 

	   datename(weekday,TblCoverManagerCover.dteDate) AS [WeekDay] 
  FROM
	  TblCoverManagerCover 
WHERE
(TblCoverManagerCover.dteDate  BETWEEN @txtStartDate AND DATEADD(Day,1,@txtEndDate) )
	  group by

	datename(weekday,TblCoverManagerCover.dteDate) )
	,

 CoverDays AS (
select * from 
(       
select 
TblCoverManagerAbsencesId,
1 AS DayOrder,
'Monday' AS [WeekDay],
 datediff(day, -7, dteEndDatetime)/7-datediff(day, -6, dteStartDateTime)/7 AS intCount
  from TblCoverManagerAbsences
 UNION  
 select
TblCoverManagerAbsencesId,
2 AS DayOrder,
'Tuesday' AS [WeekDay],
 datediff(day, -6, dteEndDatetime)/7-datediff(day, -5, dteStartDateTime)/7 AS intCount
  from TblCoverManagerAbsences
   UNION  
 select
TblCoverManagerAbsencesId,
3 AS DayOrder,
'Wednesday' AS [WeekDay],
datediff(day, -5, dteEndDatetime)/7-datediff(day, -4, dteStartDateTime)/7 AS intCount
  from TblCoverManagerAbsences
     UNION  
 select
TblCoverManagerAbsencesId,
4 AS DayOrder,
'Thursday' AS [WeekDay],
datediff(day, -4, dteEndDatetime)/7-datediff(day, -3, dteStartDateTime)/7  AS intCount
  from TblCoverManagerAbsences
       UNION  
 select
TblCoverManagerAbsencesId,
5 AS DayOrder,
'Friday' AS [WeekDay],
datediff(day, -3, dteEndDatetime)/7-datediff(day, -2, dteStartDateTime)/7  AS intCount
  from TblCoverManagerAbsences
         UNION  
 select
TblCoverManagerAbsencesId,
6 AS DayOrder,
'Saturday' AS [WeekDay],
datediff(day, -2, dteEndDatetime)/7-datediff(day, -1, dteStartDateTime)/7  AS intCount
  from TblCoverManagerAbsences
           UNION  
 select
TblCoverManagerAbsencesId,
7 AS DayOrder,
'Sunday' AS [WeekDay],
datediff(day, -1, dteEndDatetime)/7-datediff(day, 0, dteStartDateTime)/7  AS intCount
  from TblCoverManagerAbsences) AS DayCount
  WHere intCount &lt;&gt; 0)

    Select 
 CoverDays.DayOrder,
  Coverdays.WeekDay,
  CoverDays.intcount,
  CoverSessions.intSessionCount,
datename(weekday,TblCoverManagerAbsences.dteStartDateTime) AS DayOfWeek, 
TblCoverManagerAbsencesReasons.TblCoverManagerAbsencesReasonsId, TblCoverManagerAbsencesReasons.txtName, TblCoverManagerAbsencesReasons.txtCode, TblCoverManagerAbsencesReasons.intOrder, 
                         TblCoverManagerAbsencesReasons.blnActive, TblCoverManagerAbsencesReasons.blnConfidential, TblCoverManagerAbsences.intCycle, TblCoverManagerAbsences.TblCoverManagerAbsencesId, 
                         TblCoverManagerAbsences.txtTeacher, TblCoverManagerAbsences.intReason, TblCoverManagerAbsences.dteStartDateTime, TblCoverManagerAbsences.dteEndDateTime, TblStaff.Title, TblStaff.Surname, TblStaff.NameInitials, 
                         TblStaff.TblStaffID, TblStaff.Initials, TblStaff.Firstname, TblCoverManagerAbsences.intStartPeriod, TblCoverManagerAbsences.intEndPeriod, 
                         CASE WHEN TblCoverManagerAbsences.intStartPeriod = 0 THEN 1 ELSE 0 END AS MyPeriodOrder



FROM            TblCoverManagerAbsences LEFT OUTER JOIN
                         TblCoverManagerAbsencesReasons ON TblCoverManagerAbsences.intReason = TblCoverManagerAbsencesReasons.TblCoverManagerAbsencesReasonsId LEFT OUTER JOIN
                         TblStaff ON TblCoverManagerAbsences.txtTeacher = TblStaff.User_Code

LEFT OUTER JOIN
CoverDays
ON TblCoverManagerAbsences.TblCoverManagerAbsencesId = CoverDays.TblCoverManagerAbsencesId

LEFT OUTER JOIN
CoverSessions
ON CoverDays.Weekday = Coversessions.Weekday

WHERE
(TblCoverManagerAbsences.dteStartDateTime BETWEEN @txtStartDate AND DATEADD(Day,1,@txtEndDate) )</CommandText><rd:UseGenericDesigner>true</rd:UseGenericDesigner></Query><Fields><Field Name="DayOrder"><DataField>DayOrder</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="WeekDay"><DataField>WeekDay</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="DayOfWeek"><DataField>DayOfWeek</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intcount"><DataField>intcount</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="intSessionCount"><DataField>intSessionCount</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="TblCoverManagerAbsencesReasonsId"><DataField>TblCoverManagerAbsencesReasonsId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtName"><DataField>txtName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtCode"><DataField>txtCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intOrder"><DataField>intOrder</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="blnActive"><DataField>blnActive</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="blnConfidential"><DataField>blnConfidential</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="intCycle"><DataField>intCycle</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="TblCoverManagerAbsencesId"><DataField>TblCoverManagerAbsencesId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtTeacher"><DataField>txtTeacher</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intReason"><DataField>intReason</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="dteStartDateTime"><DataField>dteStartDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="dteEndDateTime"><DataField>dteEndDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="Title"><DataField>Title</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="Surname"><DataField>Surname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="NameInitials"><DataField>NameInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="TblStaffID"><DataField>TblStaffID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="Initials"><DataField>Initials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="Firstname"><DataField>Firstname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intStartPeriod"><DataField>intStartPeriod</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="intEndPeriod"><DataField>intEndPeriod</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="MyPeriodOrder"><DataField>MyPeriodOrder</DataField><rd:TypeName>System.Int32</rd:TypeName></Field></Fields></DataSet><DataSet Name="CoverManager"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></QueryParameter><QueryParameter Name="@txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></QueryParameter></QueryParameters><CommandText>SELECT 
vwCoverManagerArrangedCover.*,
CoveredRoom.txtName AS CoveredRoom,
CoveringRoom.txtName AS CoveringRoom,

	datename(weekday,dteDate) AS [WeekDay] 

 from
vwCoverManagerArrangedCover

LEFT OUTER JOIN 
	[dbo].[TblSchoolManagementClassrooms] AS CoveredRoom
	ON vwCoverManagerArrangedCover.CoveredRoomCode = 	CoveredRoom.txtCode

LEFT OUTER JOIN 
	[dbo].[TblSchoolManagementClassrooms] AS CoveringRoom
	ON vwCoverManagerArrangedCover.CoveringRoomCode = 	CoveringRoom.txtCode


WHERE
 
 (dteDate  BETWEEN @txtStartDate AND DATEADD(Day,1,@txtEndDate) )</CommandText><rd:UseGenericDesigner>true</rd:UseGenericDesigner></Query><Fields><Field Name="intCycle"><DataField>intCycle</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="TblCoverManagerCoverID"><DataField>TblCoverManagerCoverId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtSubmitBy"><DataField>txtSubmitBy</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="dteSubmitDateTime"><DataField>dteSubmitDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="TblTimetableManagerScheduleId"><DataField>TblTimetableManagerScheduleId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="blnPublished"><DataField>blnPublished</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="CoveredTeacherCode"><DataField>CoveredTeacherCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherEmail"><DataField>CoveredTeacherEmail</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherMobile"><DataField>CoveredTeacherMobile</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherInitials"><DataField>CoveredTeacherInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherSalutation"><DataField>CoveredTeacherSalutation</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherSurname"><DataField>CoveredTeacherSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherForename"><DataField>CoveredTeacherForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherPreName"><DataField>CoveredTeacherPreName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="PeriodOrder"><DataField>PeriodOrder</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtShortPeriodName"><DataField>txtShortPeriodName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtShortDayName"><DataField>txtShortDayName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtShortWeekName"><DataField>txtShortWeekName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intRoom"><DataField>intRoom</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="CoveringTeacherCode"><DataField>CoveringTeacherCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherEmail"><DataField>CoveringTeacherEmail</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherMobile"><DataField>CoveringTeacherMobile</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherInitials"><DataField>CoveringTeacherInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherSalutation"><DataField>CoveringTeacherSalutation</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="dteDate"><DataField>dteDate</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="txtCode"><DataField>txtCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherSurname"><DataField>CoveringTeacherSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherForename"><DataField>CoveringTeacherForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherPreName"><DataField>CoveringTeacherPreName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="WeekDay"><DataField>WeekDay</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredRoomCode"><DataField>CoveredRoomCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredRoomInitials"><DataField>CoveredRoomInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringRoomCode"><DataField>CoveringRoomCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringRoomInitials"><DataField>CoveringRoomInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtSubjectName"><DataField>txtSubjectName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredRoom"><DataField>CoveredRoom</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringRoom"><DataField>CoveringRoom</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="YearToDate"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></QueryParameter></QueryParameters><CommandText>With SchoolYearDates AS 
(select 
intschoolyear,
MIN(txtStartDate) ACyearStart,
Max(txtFinishDate) ACYearEND
from 
tblschoolmanagementtermdates
Group by
intschoolyear)

SELECT 
vwCoverManagerArrangedCover.*,
intSchoolYear
 from
vwCoverManagerArrangedCover

left outer join
SchoolYearDates
ON vwCoverManagerArrangedCover.dteDate Between SchoolYearDates.AcYearStart AND SchoolYearDates.ACYearEnd

WHERE 
SchoolYearDates.intSchoolYear Between (( select intschoolyear from SchoolYearDates where @txtStartDate Between SchoolYearDates.AcYearStart AND SchoolYearDates.ACYearEnd)-3)
AND
 ((select intschoolyear from SchoolYearDates where @txtStartDate Between SchoolYearDates.AcYearStart AND SchoolYearDates.ACYearEnd))</CommandText><rd:UseGenericDesigner>true</rd:UseGenericDesigner></Query><Fields><Field Name="intCycle"><DataField>intCycle</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="dteDate"><DataField>dteDate</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="TblCoverManagerCoverId"><DataField>TblCoverManagerCoverId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtSubmitBy"><DataField>txtSubmitBy</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="dteSubmitDateTime"><DataField>dteSubmitDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="TblTimetableManagerScheduleId"><DataField>TblTimetableManagerScheduleId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="blnPublished"><DataField>blnPublished</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="CoveredTeacherCode"><DataField>CoveredTeacherCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherEmail"><DataField>CoveredTeacherEmail</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherMobile"><DataField>CoveredTeacherMobile</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherInitials"><DataField>CoveredTeacherInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherSalutation"><DataField>CoveredTeacherSalutation</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherSurname"><DataField>CoveredTeacherSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherForename"><DataField>CoveredTeacherForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredTeacherPreName"><DataField>CoveredTeacherPreName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="PeriodOrder"><DataField>PeriodOrder</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtShortPeriodName"><DataField>txtShortPeriodName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtShortDayName"><DataField>txtShortDayName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtShortWeekName"><DataField>txtShortWeekName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtCode"><DataField>txtCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intRoom"><DataField>intRoom</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="CoveringTeacherCode"><DataField>CoveringTeacherCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherEmail"><DataField>CoveringTeacherEmail</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherMobile"><DataField>CoveringTeacherMobile</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherInitials"><DataField>CoveringTeacherInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherSalutation"><DataField>CoveringTeacherSalutation</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherSurname"><DataField>CoveringTeacherSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherForename"><DataField>CoveringTeacherForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringTeacherPreName"><DataField>CoveringTeacherPreName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredRoomCode"><DataField>CoveredRoomCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveredRoomInitials"><DataField>CoveredRoomInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringRoomCode"><DataField>CoveringRoomCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CoveringRoomInitials"><DataField>CoveringRoomInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtSubjectName"><DataField>txtSubjectName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intSchoolYear"><DataField>intSchoolYear</DataField><rd:TypeName>System.Int32</rd:TypeName></Field></Fields></DataSet></DataSets><ReportSections><ReportSection><Body><ReportItems><Rectangle Name="Rectangle1"><ReportItems><Tablix Name="Tablix3"><TablixBody><TablixColumns><TablixColumn><Width>9.1cm</Width></TablixColumn><TablixColumn><Width>2.81052cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox3"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Absent Teachers (Absences)</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox1</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><BackgroundColor>#8eceec</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox5"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Absences</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox3</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><BackgroundColor>#cbe3ba</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="txtName5"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!Surname.Value + ", " + Fields!Firstname.Value</Value><ActionInfo><Actions><Action><Drillthrough><ReportName>Teacher Dashboard</ReportName><Parameters><Parameter Name="txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></Parameter><Parameter Name="txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></Parameter><Parameter Name="txtTeacher"><Value>=Fields!txtTeacher.Value</Value></Parameter></Parameters></Drillthrough></Action></Actions></ActionInfo><Style><TextDecoration>Underline</TextDecoration><Color>DimGray</Color></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>txtName</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="TblCoverManagerAbsencesId3"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=CountDistinct(Fields!TblCoverManagerAbsencesId.Value)</Value><ActionInfo><Actions><Action><Drillthrough><ReportName>Cover Absence Report by Date</ReportName><Parameters><Parameter Name="TblCoverManagerAbsencesId"><Value>=JOIN(LookupSet(Fields!txtTeacher.Value, Fields!txtTeacher.Value, Fields!TblCoverManagerAbsencesId.Value, "CoverAbsences"), ",")</Value></Parameter><Parameter Name="txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></Parameter><Parameter Name="txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></Parameter></Parameters></Drillthrough></Action></Actions></ActionInfo><Style><TextDecoration>Underline</TextDecoration><Color>DimGray</Color></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>TblCoverManagerAbsencesId1</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="StaffAbsences"><GroupExpressions><GroupExpression>=Fields!TblStaffID.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=CountDistinct(Fields!TblCoverManagerAbsencesId.Value)</Value><Direction>Descending</Direction></SortExpression><SortExpression><Value>=Fields!Surname.Value</Value></SortExpression><SortExpression><Value>=Fields!Firstname.Value</Value></SortExpression></SortExpressions><TablixMembers><TablixMember /></TablixMembers></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>CoverAbsences</DataSetName><Filters><Filter><FilterExpression>=Parameters!DataTable.Value</FilterExpression><Operator>Equal</Operator><FilterValues><FilterValue>AbsentAbsences</FilterValue></FilterValues></Filter></Filters><Top>1.5875cm</Top><Left>0.03528cm</Left><Height>1.2cm</Height><Width>11.91052cm</Width><Visibility><Hidden>=IIF(Parameters!DataTable.Value="AbsentAbsences", False, True)</Hidden></Visibility><Style><Border><Style>None</Style></Border></Style></Tablix><Tablix Name="Tablix10"><TablixBody><TablixColumns><TablixColumn><Width>9.1cm</Width></TablixColumn><TablixColumn><Width>2.81052cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox107"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Cover Teachers</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox103</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><BackgroundColor>#8eceec</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox108"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Sessions</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox105</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><BackgroundColor>#cbe3ba</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="txtName4"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!CoveringTeacherSurname.Value + ", " + Fields!CoveringTeacherForename.Value</Value><ActionInfo><Actions><Action><Drillthrough><ReportName>Teacher Dashboard</ReportName><Parameters><Parameter Name="txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></Parameter><Parameter Name="txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></Parameter><Parameter Name="txtTeacher"><Value>=Fields!CoveringTeacherCode.Value</Value></Parameter></Parameters></Drillthrough></Action></Actions></ActionInfo><Style><TextDecoration>Underline</TextDecoration><Color>DimGray</Color></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>txtName</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="TblCoverManagerCoverID2"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=CountDistinct(Fields!TblCoverManagerCoverID.Value)</Value><ActionInfo><Actions><Action><Drillthrough><ReportName>Cover Report by Covering Teacher</ReportName><Parameters><Parameter Name="TblCoverManagerCoverID"><Value>=JOIN(LookupSet(Fields!CoveringTeacherCode.Value, Fields!CoveringTeacherCode.Value, Fields!TblCoverManagerCoverID.Value, "CoverManager"), ",")</Value></Parameter><Parameter Name="txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></Parameter><Parameter Name="txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></Parameter></Parameters></Drillthrough></Action></Actions></ActionInfo><Style><TextDecoration>Underline</TextDecoration><Color>DimGray</Color></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>TblCoverManagerCoverID</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="Details1"><GroupExpressions><GroupExpression>=Fields!CoveringTeacherCode.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=CountDistinct(Fields!TblCoverManagerCoverID.Value)</Value><Direction>Descending</Direction></SortExpression></SortExpressions></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>CoverManager</DataSetName><Filters><Filter><FilterExpression>=Parameters!DataTable.Value</FilterExpression><Operator>Equal</Operator><FilterValues><FilterValue>CoverTeachers</FilterValue></FilterValues></Filter></Filters><Top>1.5875cm</Top><Left>0.03528cm</Left><Height>1.2cm</Height><Width>11.91052cm</Width><ZIndex>1</ZIndex><Visibility><Hidden>=IIF(Parameters!DataTable.Value="CoverTeachers",False,True)</Hidden></Visibility><Style><Border><Style>None</Style></Border></Style></Tablix><Tablix Name="Tablix11"><TablixBody><TablixColumns><TablixColumn><Width>9.1cm</Width></TablixColumn><TablixColumn><Width>2.81052cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox105"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Absent Teachers (Sessions)</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox103</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><BackgroundColor>#8eceec</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox109"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Sessions</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox105</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><BackgroundColor>#cbe3ba</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="txtName6"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!CoveredTeacherSurname.Value + ", " + Fields!CoveredTeacherForename.Value</Value><ActionInfo><Actions><Action><Drillthrough><ReportName>Teacher Dashboard</ReportName><Parameters><Parameter Name="txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></Parameter><Parameter Name="txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></Parameter><Parameter Name="txtTeacher"><Value>=Fields!CoveredTeacherCode.Value</Value></Parameter></Parameters></Drillthrough></Action></Actions></ActionInfo><Style><TextDecoration>Underline</TextDecoration><Color>DimGray</Color></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>txtName</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="TblCoverManagerCoverID3"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=CountDistinct(Fields!TblCoverManagerCoverID.Value)</Value><ActionInfo><Actions><Action><Drillthrough><ReportName>Cover Report by Covering For</ReportName><Parameters><Parameter Name="TblCoverManagerCoverID"><Value>=JOIN(LookupSet(Fields!CoveredTeacherCode.Value, Fields!CoveredTeacherCode.Value, Fields!TblCoverManagerCoverID.Value, "CoverManager"), ",")</Value></Parameter><Parameter Name="txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></Parameter><Parameter Name="txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></Parameter></Parameters></Drillthrough></Action></Actions></ActionInfo><Style><TextDecoration>Underline</TextDecoration><Color>DimGray</Color></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>TblCoverManagerCoverID</rd:DefaultName><Style><Border><Style>Solid</Style><Width>0.5pt</Width></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="Details2"><GroupExpressions><GroupExpression>=Fields!CoveredTeacherCode.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=CountDistinct(Fields!TblCoverManagerCoverID.Value)</Value><Direction>Descending</Direction></SortExpression></SortExpressions></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>CoverManager</DataSetName><Filters><Filter><FilterExpression>=Parameters!DataTable.Value</FilterExpression><Operator>Equal</Operator><FilterValues><FilterValue>AbsentSessions</FilterValue></FilterValues></Filter></Filters><Top>1.5875cm</Top><Left>0.03528cm</Left><Height>1.2cm</Height><Width>11.91052cm</Width><ZIndex>2</ZIndex><Visibility><Hidden>=IIF(Parameters!DataTable.Value="AbsentSessions",false, true)</Hidden></Visibility><Style><Border><Style>None</Style></Border></Style></Tablix><Textbox Name="Textbox8"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Switch(
Parameters!DataTable.Value="AbsentAbsences","Absent Teachers (Absences)",
Parameters!DataTable.Value="CoverTeachers", "Covering Teachers (Sessions)",
Parameters!DataTable.Value="AbsentSessions","Abesnt Teachers (Sessions)",
True,"")</Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight></Style></TextRun><TextRun><Value xml:space="preserve"> </Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight></Style></TextRun><TextRun><Value>=Parameters!txtStartDate.Value</Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight><Format>d</Format></Style></TextRun><TextRun><Value> - </Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight><Format>d</Format></Style></TextRun><TextRun><Value>=Parameters!txtEndDate.Value</Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight><Format>d</Format></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox1</rd:DefaultName><Height>1.3cm</Height><Width>27.7cm</Width><ZIndex>3</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Image Name="Image1"><Source>Embedded</Source><Value>iSAMSLine</Value><Sizing>FitProportional</Sizing><Top>1.03446cm</Top><Height>0.26613cm</Height><Width>27.7cm</Width><ZIndex>4</ZIndex><Style><Border><Style>None</Style></Border></Style></Image></ReportItems><KeepTogether>true</KeepTogether><Height>2.99917cm</Height><Width>27.7cm</Width><Style><Border><Style>None</Style></Border></Style></Rectangle></ReportItems><Height>2.99917cm</Height><Style /></Body><Width>27.7cm</Width><Page><PageHeight>21cm</PageHeight><PageWidth>29.7cm</PageWidth><InteractiveHeight>29.7cm</InteractiveHeight><InteractiveWidth>21cm</InteractiveWidth><LeftMargin>1cm</LeftMargin><RightMargin>1cm</RightMargin><TopMargin>1cm</TopMargin><BottomMargin>0cm</BottomMargin><ColumnSpacing>1cm</ColumnSpacing><Style /></Page></ReportSection></ReportSections><ReportParameters><ReportParameter Name="txtStartDate"><DataType>DateTime</DataType><Prompt>Date From:</Prompt></ReportParameter><ReportParameter Name="txtEndDate"><DataType>DateTime</DataType><Prompt>Date To:</Prompt></ReportParameter><ReportParameter Name="DataTable"><DataType>String</DataType><Prompt>DataTable</Prompt><Hidden>true</Hidden></ReportParameter></ReportParameters><Code>Public Shared Function RemoveDuplicates(m_Array As Object()) As String()

    System.Array.Sort(m_Array)
    Dim k As Integer = 0
    For i As Integer = 0 To m_Array.Length - 1
        If i &gt; 0 AndAlso m_Array(i).Equals(m_Array(i - 1)) Then
            Continue For
        End If
        m_Array(k) = m_Array(i)
        k += 1
    Next

    Dim unique As [String]() = New [String](k - 1) {}

    System.Array.Copy(m_Array, 0, unique, 0, k)

    Return unique

End Function</Code><EmbeddedImages><EmbeddedImage Name="iSAMSLine"><MIMEType>image/png</MIMEType><ImageData>iVBORw0KGgoAAAANSUhEUgAAAs8AAAAECAIAAAD+oEW+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAINSURBVGhD7ZYxSoNBEIUtNL1NFImeIPEQ1h7BSwiJpWhl5Q38QYx1tJF4CisLo8cQrd1kYJnMPOaNqRcey8zb7+tn67D7rBncLeoblAaQBK6eIWBKnQDQXxALSj1nLN9QlwKm9A11KWBKCEhKOei+Bt3nUfdR3sNucXrzdnl8+9y/ft5b5ql/Vd8aX1Kgxlt5V5K0kphZ85aOBgKXAqbUc2B52KxByYFVyjA7OH8/O/m93/2e9n6X2fl52K5vjS8pYEoISIIvCQR8SYEab+VdSdJKYmbNWzoagK6eIbCGTXvfjzsvs/2L+Wj8OiyZzI/H8+HkdVQjq351b1ZY6vm/lm6oSwGzQkASfEkg4EsKwECMukkricnaro2U5RvqUsCUvqEuBUwJAUkp27WxmaWjgcClgCn1HFgeNmtQcmCVMrRrA2KBK0laScyseUtHA9DVMwTWsHZtOEASfEkg4EsKwECMukkricnaro2U5RvqUsCUvqEuBUwJAUkp27WxmaWjgcClgCn1HFgeNmtQcmCVMrRrA2KBK0laScyseUtHA9DVMwTWsHZtOEASfEkg4EsKwECMukkricnaro2U5RvqUsCUvqEuBUwJAUkp27WxmaWjgcClgCn1HFgeNmtQcmCVMrRrA2KBK0laScyseUtHA9DVMwTWsHZtOEASfEkg4EsKwECMukkriS3X+fAPfoNWybNefjEAAAAASUVORK5CYII=</ImageData></EmbeddedImage></EmbeddedImages><Language>en-GB</Language><ConsumeContainerWhitespace>true</ConsumeContainerWhitespace><rd:ReportUnitType>Cm</rd:ReportUnitType><rd:ReportID>6f17c384-dc47-4cee-9f7e-463d34d72b5a</rd:ReportID></Report>