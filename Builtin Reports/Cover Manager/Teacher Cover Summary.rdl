<?xml version="1.0" encoding="utf-8"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition"><DataSources><DataSource Name="iSAMS"><DataSourceReference>iSAMS</DataSourceReference><rd:DataSourceID xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">b4ea1cd1-b2a0-4d56-b841-062d87ecfc0e</rd:DataSourceID><rd:SecurityType xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">None</rd:SecurityType></DataSource></DataSources><DataSets><DataSet Name="Main"><Fields><Field Name="TblCoverManagerAbsencesId"><DataField>TblCoverManagerAbsencesID</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.Int32</rd:TypeName></Field><Field Name="Type"><DataField>Type</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.Int32</rd:TypeName></Field><Field Name="Surname"><DataField>Surname</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="Firstname"><DataField>Firstname</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="Initials"><DataField>Initials</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="txtTeacher"><DataField>txtTeacher</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field></Fields><Query><DataSourceName>iSAMS</DataSourceName><CommandText>SELECT     TblCoverManagerAbsencesID, 1 AS Type, TblStaff.Surname, TblStaff.Firstname, TblStaff.Initials, TblCoverManagerAbsences.txtTeacher 

FROM            TblCoverManagerAbsences 

LEFT OUTER JOIN TblStaff ON  TblCoverManagerAbsences.txtTeacher = TblStaff.User_Code
WHERE (TblCoverManagerAbsences.intCycle IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@intCycle) AS SplitCSV_1) OR
                         @intCycle IS NULL)
AND (TblCoverManagerAbsences.txtTeacher IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtTeacher) AS SplitCSV_1) OR
                         @txtTeacher IS NULL)
AND ((TblCoverManagerAbsences.dteStartDateTime BETWEEN @txtStartDate AND @txtEndDate) OR
                         (TblCoverManagerAbsences.dteEndDateTime BETWEEN @txtStartDate AND @txtEndDate) or @txtEndDate is null or @txtEndDate is null)

UNION 

SELECT     TblCoverManagerUnavailableID, 2 AS Type,TblStaff.Surname, TblStaff.Firstname, TblStaff.Initials, TblCoverManagerUnavailable.txtTeacher

FROM            TblCoverManagerUnavailable


LEFT OUTER JOIN TblStaff ON  TblCoverManagerUnavailable.txtTeacher= TblStaff.User_Code
WHERE (TblCoverManagerUnavailable.intCycle IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@intCycle) AS SplitCSV_1) OR
                         @intCycle IS NULL)
AND (TblCoverManagerUnavailable.txtTeacher IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtTeacher) AS SplitCSV_1) OR
                         @txtTeacher IS NULL)
AND ((TblCoverManagerUnavailable.dteStartDateTime BETWEEN @txtStartDate AND @txtEndDate) OR
                         (TblCoverManagerUnavailable.dteEndDateTime BETWEEN @txtStartDate AND @txtEndDate) or @txtEndDate is null or @txtEndDate is null)



UNION 
SELECT      TblCoverManagerCoverID, 3 AS Type, TblStaff.Surname, TblStaff.Firstname, TblStaff.Initials, TblCoverManagerCover.txtCoverTeacher 

FROM             TblCoverManagerCover

LEFT OUTER JOIN TblStaff ON  TblCoverManagerCover.txtCoverTeacher = TblStaff.User_Code
WHERE (TblCoverManagerCover.intCycle IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@intCycle) AS SplitCSV_1) OR
                         @intCycle IS NULL)
AND (TblCoverManagerCover.txtCoverTeacher  IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtTeacher) AS SplitCSV_1) OR
                         @txtTeacher IS NULL)

AND (TblCoverManagerCover.dteDate BETWEEN @txtStartDate AND @txtEndDate or @txtEndDate is null or @txtEndDate is null)</CommandText><QueryParameters><QueryParameter Name="@intCycle"><Value>=Parameters!intCycle.Value</Value></QueryParameter><QueryParameter Name="@txtTeacher"><Value>=Parameters!txtTeacher.Value</Value></QueryParameter><QueryParameter Name="@txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></QueryParameter><QueryParameter Name="@txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></QueryParameter></QueryParameters><rd:UseGenericDesigner xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">true</rd:UseGenericDesigner></Query></DataSet></DataSets><Body><ReportItems><Tablix Name="table1"><TablixBody><TablixColumns><TablixColumn><Width>3.74016in</Width></TablixColumn><TablixColumn><Width>1.37795in</Width></TablixColumn><TablixColumn><Width>1.37795in</Width></TablixColumn><TablixColumn><Width>1.37795in</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.19685in</Height><TablixCells><TablixCell><CellContents><Textbox Name="textbox1"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Teacher</Value><Style><FontFamily>Times New Roman</FontFamily><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox1</rd:DefaultName><ZIndex>15</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox2"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Times Absent</Value><Style><FontFamily>Times New Roman</FontFamily><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox2</rd:DefaultName><ZIndex>14</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox3"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Times Unavailable</Value><Style><FontFamily>Times New Roman</FontFamily><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox3</rd:DefaultName><ZIndex>13</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox16"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Periods Covered</Value><Style><FontFamily>Times New Roman</FontFamily><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox16</rd:DefaultName><ZIndex>12</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.19685in</Height><TablixCells><TablixCell><CellContents><Textbox Name="textbox10"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!Surname.Value + ", " + Fields!Firstname.Value + " [" + Fields!Initials.Value + "]"</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox10</rd:DefaultName><ZIndex>11</ZIndex><Style><Border><Color>Silver</Color><Style>None</Style><Width>0.5pt</Width></Border><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox11"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=SUM(IIF(Fields!Type.Value=1,1,0))</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox11</rd:DefaultName><ZIndex>10</ZIndex><Style><Border><Color>Silver</Color><Style>None</Style><Width>0.5pt</Width></Border><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox12"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=SUM(IIF(Fields!Type.Value=2,1,0))</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox12</rd:DefaultName><ZIndex>9</ZIndex><Style><Border><Color>Silver</Color><Style>None</Style><Width>0.5pt</Width></Border><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox18"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=SUM(IIF(Fields!Type.Value=3,1,0))</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><ZIndex>8</ZIndex><Style><Border><Color>Silver</Color><Style>None</Style><Width>0.5pt</Width></Border><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.19685in</Height><TablixCells><TablixCell><CellContents><Textbox Name="textbox5"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Total</Value><Style><FontFamily>Times New Roman</FontFamily><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">textbox5</rd:DefaultName><ZIndex>7</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox9"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=SUM(IIF(Fields!Type.Value=1,1,0))</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><ZIndex>6</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox6"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=SUM(IIF(Fields!Type.Value=2,1,0))</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><ZIndex>5</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="textbox17"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=SUM(IIF(Fields!Type.Value=3,1,0))</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><ZIndex>4</ZIndex><Style><Border><Style>None</Style><Width>0.5pt</Width></Border><TopBorder><Style>Solid</Style></TopBorder><BottomBorder><Style>Solid</Style></BottomBorder><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>1pt</PaddingTop><PaddingBottom>1pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup><KeepTogether>true</KeepTogether></TablixMember><TablixMember><Group Name="table1_Group1"><GroupExpressions><GroupExpression>=Fields!txtTeacher.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=Fields!Surname.Value</Value></SortExpression><SortExpression><Value>=Fields!Firstname.Value</Value></SortExpression></SortExpressions><TablixMembers><TablixMember><KeepTogether>true</KeepTogether></TablixMember></TablixMembers></TablixMember><TablixMember><KeepWithGroup>Before</KeepWithGroup><KeepTogether>true</KeepTogether></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>Main</DataSetName><Left>0.5cm</Left><Height>1.5cm</Height><Width>20cm</Width><Style /></Tablix></ReportItems><Height>1.5cm</Height><Style /></Body><ReportParameters><ReportParameter Name="intCycle"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><Values><Value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>intCycle</Prompt></ReportParameter><ReportParameter Name="txtTeacher"><DataType>String</DataType><Nullable>true</Nullable><DefaultValue><Values><Value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>txtTeacher</Prompt></ReportParameter><ReportParameter Name="txtStartDate"><DataType>DateTime</DataType><Nullable>true</Nullable><DefaultValue><Values><Value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>txtStartDate</Prompt></ReportParameter><ReportParameter Name="txtEndDate"><DataType>DateTime</DataType><Nullable>true</Nullable><DefaultValue><Values><Value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /></Values></DefaultValue><AllowBlank>true</AllowBlank><Prompt>txtEndDate</Prompt></ReportParameter></ReportParameters><Width>21cm</Width><Page><PageHeader><Height>0.8cm</Height><PrintOnFirstPage>true</PrintOnFirstPage><PrintOnLastPage>true</PrintOnLastPage><ReportItems><Textbox Name="textbox4"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>="Teacher Cover Summary " +  IIF(isnothing(Parameters!txtStartDate.Value) or isNothing(Parameters!txtEndDate.Value),""," from " + Format(Parameters!txtStartDate.Value,"dd/MM/yyyy") + " to " + Format(Parameters!txtEndDate.Value,"dd/MM/yyyy"))</Value><Style><FontFamily>Times New Roman</FontFamily><FontSize>14pt</FontSize><FontWeight>Bold</FontWeight><Language>en-GB</Language></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><Left>0.5cm</Left><Height>0.7cm</Height><Width>20cm</Width><Style><Border><Style>None</Style></Border><BottomBorder><Style>Solid</Style></BottomBorder><VerticalAlign>Top</VerticalAlign><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight></Style></Textbox></ReportItems><Style /></PageHeader><PageFooter><Height>0.75cm</Height><PrintOnFirstPage>true</PrintOnFirstPage><PrintOnLastPage>true</PrintOnLastPage><ReportItems><Textbox Name="textbox57"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>="Printed on: " + Format(Now(),"dd/MM/yyyy hh:mm")</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><Top>0.2cm</Top><Left>0.5cm</Left><Height>0.5cm</Height><Width>16.5cm</Width><Style><Border><Style>None</Style></Border><TopBorder><Style>Solid</Style></TopBorder><VerticalAlign>Middle</VerticalAlign><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight></Style></Textbox><Textbox Name="textbox25"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>="Page: " + Cstr(Globals!PageNumber) + " out of " + Cstr(Globals!TotalPages)</Value><Style><FontFamily>Times New Roman</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Right</TextAlign></Style></Paragraph></Paragraphs><Top>0.2cm</Top><Left>17cm</Left><Height>0.5cm</Height><Width>3.5cm</Width><ZIndex>1</ZIndex><Style><Border><Style>None</Style></Border><TopBorder><Style>Solid</Style></TopBorder><VerticalAlign>Middle</VerticalAlign><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight></Style></Textbox></ReportItems><Style /></PageFooter><PageHeight>29.7cm</PageHeight><PageWidth>21cm</PageWidth><LeftMargin>0cm</LeftMargin><RightMargin>0cm</RightMargin><TopMargin>0.5cm</TopMargin><BottomMargin>0.5cm</BottomMargin><ColumnSpacing>1cm</ColumnSpacing><Style /></Page><Language>en-US</Language><ConsumeContainerWhitespace>true</ConsumeContainerWhitespace><rd:ReportID xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">1cc36016-d5a1-4f43-a0dc-6c9c9e574d9e</rd:ReportID><rd:ReportUnitType xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Cm</rd:ReportUnitType></Report>