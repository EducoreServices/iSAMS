<?xml version="1.0" encoding="utf-8"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner"><AutoRefresh>0</AutoRefresh><DataSources><DataSource Name="iSAMS"><DataSourceReference>iSAMS</DataSourceReference><rd:SecurityType>None</rd:SecurityType><rd:DataSourceID>3e0e201a-c88c-4919-a240-b67a5b067986</rd:DataSourceID></DataSource></DataSources><DataSets><DataSet Name="CoverAbsences"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></QueryParameter><QueryParameter Name="@txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></QueryParameter><QueryParameter Name="@AbsenceReason"><Value>=Parameters!AbsenceReason.Value</Value></QueryParameter></QueryParameters><CommandText>select 

TblCoverManagerAbsencesReasons.TblCoverManagerAbsencesReasonsId, TblCoverManagerAbsencesReasons.txtName, TblCoverManagerAbsencesReasons.txtCode, TblCoverManagerAbsencesReasons.intOrder, 
                         TblCoverManagerAbsencesReasons.blnActive, TblCoverManagerAbsencesReasons.blnConfidential, TblCoverManagerAbsences.intCycle, TblCoverManagerAbsences.TblCoverManagerAbsencesId, 
                         TblCoverManagerAbsences.txtTeacher, TblCoverManagerAbsences.intReason, TblCoverManagerAbsences.dteStartDateTime, TblCoverManagerAbsences.dteEndDateTime, TblStaff.Title, TblStaff.Surname, TblStaff.NameInitials, 
                         TblStaff.TblStaffID, TblStaff.Initials, TblStaff.Firstname, TblCoverManagerAbsences.intStartPeriod, TblCoverManagerAbsences.intEndPeriod, 
                         CASE WHEN TblCoverManagerAbsences.intStartPeriod = 0 THEN 1 ELSE 0 END AS MyPeriodOrder



FROM            TblCoverManagerAbsences LEFT OUTER JOIN
                         TblCoverManagerAbsencesReasons ON TblCoverManagerAbsences.intReason = TblCoverManagerAbsencesReasons.TblCoverManagerAbsencesReasonsId LEFT OUTER JOIN
                         TblStaff ON TblCoverManagerAbsences.txtTeacher = TblStaff.User_Code



WHERE
(TblCoverManagerAbsences.dteStartDateTime BETWEEN @txtStartDate AND DATEADD(Day,1,@txtEndDate) )

AND TblCoverManagerAbsencesReasons.TblCoverManagerAbsencesReasonsId IN (@AbsenceReason)

</CommandText><rd:UseGenericDesigner>true</rd:UseGenericDesigner></Query><Fields><Field Name="TblCoverManagerAbsencesReasonsId"><DataField>TblCoverManagerAbsencesReasonsId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtName"><DataField>txtName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtCode"><DataField>txtCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intOrder"><DataField>intOrder</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="blnActive"><DataField>blnActive</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="blnConfidential"><DataField>blnConfidential</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="intCycle"><DataField>intCycle</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="TblCoverManagerAbsencesId"><DataField>TblCoverManagerAbsencesId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtTeacher"><DataField>txtTeacher</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intReason"><DataField>intReason</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="dteStartDateTime"><DataField>dteStartDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="dteEndDateTime"><DataField>dteEndDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="Title"><DataField>Title</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="Surname"><DataField>Surname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="NameInitials"><DataField>NameInitials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="TblStaffID"><DataField>TblStaffID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="Initials"><DataField>Initials</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="Firstname"><DataField>Firstname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intStartPeriod"><DataField>intStartPeriod</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="intEndPeriod"><DataField>intEndPeriod</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="MyPeriodOrder"><DataField>MyPeriodOrder</DataField><rd:TypeName>System.Int32</rd:TypeName></Field></Fields></DataSet><DataSet Name="Absences"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></QueryParameter><QueryParameter Name="@txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></QueryParameter></QueryParameters><CommandText>Select Distinct
TblCoverManagerAbsencesReasons.TblCoverManagerAbsencesReasonsId, 
TblCoverManagerAbsencesReasons.txtName AS txtAbsenceReason



FROM            TblCoverManagerAbsences LEFT OUTER JOIN
                         TblCoverManagerAbsencesReasons ON TblCoverManagerAbsences.intReason = TblCoverManagerAbsencesReasons.TblCoverManagerAbsencesReasonsId LEFT OUTER JOIN
                         TblStaff ON TblCoverManagerAbsences.txtTeacher = TblStaff.User_Code



WHERE
(TblCoverManagerAbsences.dteStartDateTime BETWEEN @txtStartDate AND DATEADD(Day,1,@txtEndDate) )

Order by
TblCoverManagerAbsencesReasons.txtName </CommandText><rd:UseGenericDesigner>true</rd:UseGenericDesigner></Query><Fields><Field Name="TblCoverManagerAbsencesReasonsId"><DataField>TblCoverManagerAbsencesReasonsId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtAbsenceReason"><DataField>txtAbsenceReason</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet></DataSets><ReportSections><ReportSection><Body><ReportItems><Rectangle Name="Rectangle1"><ReportItems><Chart Name="Chart4"><ChartCategoryHierarchy><ChartMembers><ChartMember><Group Name="Chart4_CategoryGroup"><GroupExpressions><GroupExpression>=Fields!txtName.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=Fields!txtName.Value</Value></SortExpression></SortExpressions><Label>=Fields!txtName.Value</Label></ChartMember></ChartMembers></ChartCategoryHierarchy><ChartSeriesHierarchy><ChartMembers><ChartMember><Label>Tbl Cover Manager Absences Id</Label></ChartMember></ChartMembers></ChartSeriesHierarchy><ChartData><ChartSeriesCollection><ChartSeries Name="TblCoverManagerAbsencesId"><ChartDataPoints><ChartDataPoint><ChartDataPointValues><Y>=Count(Fields!TblCoverManagerAbsencesId.Value)</Y></ChartDataPointValues><ChartDataLabel><Style /><Label>#PERCENT{P1}</Label><Visible>true</Visible></ChartDataLabel><ToolTip>=Fields!txtName.Value</ToolTip><ActionInfo><Actions><Action><Drillthrough><ReportName>Cover Absence Report by Date</ReportName><Parameters><Parameter Name="TblCoverManagerAbsencesId"><Value>=JOIN(LookupSet(Fields!txtName.Value, Fields!txtName.Value, Fields!TblCoverManagerAbsencesId.Value,"CoverAbsences"),",")</Value></Parameter><Parameter Name="txtStartDate"><Value>=Parameters!txtStartDate.Value</Value></Parameter><Parameter Name="txtEndDate"><Value>=Parameters!txtEndDate.Value</Value></Parameter></Parameters></Drillthrough></Action></Actions></ActionInfo><Style /><ChartMarker><Style /></ChartMarker><DataElementOutput>Output</DataElementOutput></ChartDataPoint></ChartDataPoints><Type>Shape</Type><Style /><ChartEmptyPoints><Style /><ChartMarker><Style /></ChartMarker><ChartDataLabel><Style /></ChartDataLabel></ChartEmptyPoints><ValueAxisName>Primary</ValueAxisName><CategoryAxisName>Primary</CategoryAxisName><ChartSmartLabel><CalloutLineColor>Black</CalloutLineColor><MinMovingDistance>0pt</MinMovingDistance></ChartSmartLabel></ChartSeries></ChartSeriesCollection></ChartData><ChartAreas><ChartArea Name="Default"><ChartCategoryAxes><ChartAxis Name="Primary"><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border><FontSize>8pt</FontSize><Color>#5c5c5c</Color></Style><ChartAxisTitle><Caption /><Style><FontSize>9pt</FontSize><Color>#5c5c5c</Color></Style></ChartAxisTitle><ChartMajorGridLines><Enabled>False</Enabled><Style><Border><Color>Gainsboro</Color></Border></Style></ChartMajorGridLines><ChartMinorGridLines><Style><Border><Color>Gainsboro</Color><Style>Dotted</Style></Border></Style></ChartMinorGridLines><ChartMajorTickMarks><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border></Style></ChartMajorTickMarks><ChartMinorTickMarks><Style><Border><Color>Gainsboro</Color></Border></Style><Length>0.5</Length></ChartMinorTickMarks><CrossAt>NaN</CrossAt><Minimum>NaN</Minimum><Maximum>NaN</Maximum><ChartAxisScaleBreak><Style /></ChartAxisScaleBreak></ChartAxis><ChartAxis Name="Secondary"><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border><FontSize>8pt</FontSize><Color>#5c5c5c</Color></Style><ChartAxisTitle><Caption /><Style><FontSize>9pt</FontSize><Color>#5c5c5c</Color></Style></ChartAxisTitle><ChartMajorGridLines><Enabled>False</Enabled><Style><Border><Color>Gainsboro</Color></Border></Style></ChartMajorGridLines><ChartMinorGridLines><Style><Border><Color>Gainsboro</Color><Style>Dotted</Style></Border></Style></ChartMinorGridLines><ChartMajorTickMarks><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border></Style></ChartMajorTickMarks><ChartMinorTickMarks><Style><Border><Color>Gainsboro</Color></Border></Style><Length>0.5</Length></ChartMinorTickMarks><CrossAt>NaN</CrossAt><Location>Opposite</Location><Minimum>NaN</Minimum><Maximum>NaN</Maximum><ChartAxisScaleBreak><Style /></ChartAxisScaleBreak></ChartAxis></ChartCategoryAxes><ChartValueAxes><ChartAxis Name="Primary"><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border><FontSize>8pt</FontSize><Color>#5c5c5c</Color></Style><ChartAxisTitle><Caption /><Style><FontSize>9pt</FontSize><Color>#5c5c5c</Color></Style></ChartAxisTitle><ChartMajorGridLines><Style><Border><Color>Gainsboro</Color></Border></Style></ChartMajorGridLines><ChartMinorGridLines><Style><Border><Color>Gainsboro</Color><Style>Dotted</Style></Border></Style></ChartMinorGridLines><ChartMajorTickMarks><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border></Style></ChartMajorTickMarks><ChartMinorTickMarks><Style><Border><Color>Gainsboro</Color></Border></Style><Length>0.5</Length></ChartMinorTickMarks><CrossAt>NaN</CrossAt><Minimum>NaN</Minimum><Maximum>NaN</Maximum><ChartAxisScaleBreak><Style /></ChartAxisScaleBreak></ChartAxis><ChartAxis Name="Secondary"><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border><FontSize>8pt</FontSize><Color>#5c5c5c</Color></Style><ChartAxisTitle><Caption /><Style><FontSize>9pt</FontSize><Color>#5c5c5c</Color></Style></ChartAxisTitle><ChartMajorGridLines><Style><Border><Color>Gainsboro</Color></Border></Style></ChartMajorGridLines><ChartMinorGridLines><Style><Border><Color>Gainsboro</Color><Style>Dotted</Style></Border></Style></ChartMinorGridLines><ChartMajorTickMarks><Style><Border><Color>Gainsboro</Color><Style>None</Style></Border></Style></ChartMajorTickMarks><ChartMinorTickMarks><Style><Border><Color>Gainsboro</Color></Border></Style><Length>0.5</Length></ChartMinorTickMarks><CrossAt>NaN</CrossAt><Location>Opposite</Location><Minimum>NaN</Minimum><Maximum>NaN</Maximum><ChartAxisScaleBreak><Style /></ChartAxisScaleBreak></ChartAxis></ChartValueAxes><Style><BackgroundColor>#00ffffff</BackgroundColor><BackgroundGradientType>None</BackgroundGradientType></Style></ChartArea></ChartAreas><ChartLegends><ChartLegend Name="Default"><Style><BackgroundGradientType>None</BackgroundGradientType><FontSize>9pt</FontSize></Style><ChartLegendTitle><Caption /><Style><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight><TextAlign>Center</TextAlign></Style></ChartLegendTitle><AutoFitTextDisabled>true</AutoFitTextDisabled><HeaderSeparatorColor>Black</HeaderSeparatorColor><ColumnSeparatorColor>Black</ColumnSeparatorColor></ChartLegend></ChartLegends><ChartTitles><ChartTitle Name="Default"><Caption>Absences by Reason</Caption><Style><BackgroundGradientType>None</BackgroundGradientType><FontWeight>Bold</FontWeight><TextAlign>Left</TextAlign><VerticalAlign>Top</VerticalAlign><Color>DimGray</Color></Style><Position>TopLeft</Position></ChartTitle></ChartTitles><Palette>Custom</Palette><ChartCustomPaletteColors><ChartCustomPaletteColor>#9901b8aa</ChartCustomPaletteColor><ChartCustomPaletteColor>#99374649</ChartCustomPaletteColor><ChartCustomPaletteColor>#99fd625e</ChartCustomPaletteColor><ChartCustomPaletteColor>#99f2c80f</ChartCustomPaletteColor><ChartCustomPaletteColor>#995f6b6d</ChartCustomPaletteColor><ChartCustomPaletteColor>#998ad4eb</ChartCustomPaletteColor><ChartCustomPaletteColor>#99fe9666</ChartCustomPaletteColor><ChartCustomPaletteColor>#99a66999</ChartCustomPaletteColor><ChartCustomPaletteColor>#993599b8</ChartCustomPaletteColor><ChartCustomPaletteColor>#99dfbfbf</ChartCustomPaletteColor><ChartCustomPaletteColor>#994ac5bb</ChartCustomPaletteColor><ChartCustomPaletteColor>#995f6b6d</ChartCustomPaletteColor><ChartCustomPaletteColor>#99fb8281</ChartCustomPaletteColor><ChartCustomPaletteColor>#99f4d25a</ChartCustomPaletteColor><ChartCustomPaletteColor>#997f898a</ChartCustomPaletteColor><ChartCustomPaletteColor>#99a4ddee</ChartCustomPaletteColor><ChartCustomPaletteColor>#99fdab89</ChartCustomPaletteColor><ChartCustomPaletteColor>#99b687ac</ChartCustomPaletteColor><ChartCustomPaletteColor>#9928738a</ChartCustomPaletteColor><ChartCustomPaletteColor>#99a78f8f</ChartCustomPaletteColor></ChartCustomPaletteColors><ChartBorderSkin><Style><BackgroundColor>Gray</BackgroundColor><BackgroundGradientType>None</BackgroundGradientType><Color>White</Color></Style></ChartBorderSkin><ChartNoDataMessage Name="NoDataMessage"><Caption>No Data Available</Caption><Style><BackgroundGradientType>None</BackgroundGradientType><FontWeight>Bold</FontWeight><TextAlign>General</TextAlign><VerticalAlign>Top</VerticalAlign></Style></ChartNoDataMessage><DataSetName>CoverAbsences</DataSetName><Top>1.905cm</Top><Height>18cm</Height><Width>27.7cm</Width><Style><Border><Color>LightGrey</Color><Style>None</Style></Border><BackgroundColor>White</BackgroundColor><BackgroundGradientType>None</BackgroundGradientType></Style></Chart><Textbox Name="Textbox8"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Cover Absences by Reason </Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight></Style></TextRun><TextRun><Value>=Parameters!txtStartDate.Value</Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight><Format>d</Format></Style></TextRun><TextRun><Value> - </Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight><Format>d</Format></Style></TextRun><TextRun><Value>=Parameters!txtEndDate.Value</Value><Style><FontFamily>arial</FontFamily><FontSize>24pt</FontSize><FontWeight>Bold</FontWeight><Format>d</Format></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox1</rd:DefaultName><Height>1.3cm</Height><Width>27.7cm</Width><ZIndex>1</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Image Name="Image1"><Source>Embedded</Source><Value>iSAMSLine</Value><Sizing>FitProportional</Sizing><Top>1.03446cm</Top><Height>0.26613cm</Height><Width>27.7cm</Width><ZIndex>2</ZIndex><Style><Border><Style>None</Style></Border></Style></Image></ReportItems><KeepTogether>true</KeepTogether><Height>19.905cm</Height><Width>27.7cm</Width><Style><Border><Style>None</Style></Border></Style></Rectangle></ReportItems><Height>19.905cm</Height><Style /></Body><Width>27.7cm</Width><Page><PageHeight>21cm</PageHeight><PageWidth>29.7cm</PageWidth><InteractiveHeight>29.7cm</InteractiveHeight><InteractiveWidth>21cm</InteractiveWidth><LeftMargin>1cm</LeftMargin><RightMargin>1cm</RightMargin><TopMargin>1cm</TopMargin><BottomMargin>0cm</BottomMargin><ColumnSpacing>1cm</ColumnSpacing><Style /></Page></ReportSection></ReportSections><ReportParameters><ReportParameter Name="txtStartDate"><DataType>DateTime</DataType><Prompt>Date From:</Prompt></ReportParameter><ReportParameter Name="txtEndDate"><DataType>DateTime</DataType><Prompt>Date To:</Prompt></ReportParameter><ReportParameter Name="AbsenceReason"><DataType>String</DataType><DefaultValue><DataSetReference><DataSetName>Absences</DataSetName><ValueField>TblCoverManagerAbsencesReasonsId</ValueField></DataSetReference></DefaultValue><Prompt>Absence Reason</Prompt><ValidValues><DataSetReference><DataSetName>Absences</DataSetName><ValueField>TblCoverManagerAbsencesReasonsId</ValueField><LabelField>txtAbsenceReason</LabelField></DataSetReference></ValidValues><MultiValue>true</MultiValue></ReportParameter></ReportParameters><Code>Public Shared Function RemoveDuplicates(m_Array As Object()) As String()

    System.Array.Sort(m_Array)
    Dim k As Integer = 0
    For i As Integer = 0 To m_Array.Length - 1
        If i &gt; 0 AndAlso m_Array(i).Equals(m_Array(i - 1)) Then
            Continue For
        End If
        m_Array(k) = m_Array(i)
        k += 1
    Next

    Dim unique As [String]() = New [String](k - 1) {}

    System.Array.Copy(m_Array, 0, unique, 0, k)

    Return unique

End Function</Code><EmbeddedImages><EmbeddedImage Name="iSAMSLine"><MIMEType>image/png</MIMEType><ImageData>iVBORw0KGgoAAAANSUhEUgAAAs8AAAAECAIAAAD+oEW+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAINSURBVGhD7ZYxSoNBEIUtNL1NFImeIPEQ1h7BSwiJpWhl5Q38QYx1tJF4CisLo8cQrd1kYJnMPOaNqRcey8zb7+tn67D7rBncLeoblAaQBK6eIWBKnQDQXxALSj1nLN9QlwKm9A11KWBKCEhKOei+Bt3nUfdR3sNucXrzdnl8+9y/ft5b5ql/Vd8aX1Kgxlt5V5K0kphZ85aOBgKXAqbUc2B52KxByYFVyjA7OH8/O/m93/2e9n6X2fl52K5vjS8pYEoISIIvCQR8SYEab+VdSdJKYmbNWzoagK6eIbCGTXvfjzsvs/2L+Wj8OiyZzI/H8+HkdVQjq351b1ZY6vm/lm6oSwGzQkASfEkg4EsKwECMukkricnaro2U5RvqUsCUvqEuBUwJAUkp27WxmaWjgcClgCn1HFgeNmtQcmCVMrRrA2KBK0laScyseUtHA9DVMwTWsHZtOEASfEkg4EsKwECMukkricnaro2U5RvqUsCUvqEuBUwJAUkp27WxmaWjgcClgCn1HFgeNmtQcmCVMrRrA2KBK0laScyseUtHA9DVMwTWsHZtOEASfEkg4EsKwECMukkricnaro2U5RvqUsCUvqEuBUwJAUkp27WxmaWjgcClgCn1HFgeNmtQcmCVMrRrA2KBK0laScyseUtHA9DVMwTWsHZtOEASfEkg4EsKwECMukkriS3X+fAPfoNWybNefjEAAAAASUVORK5CYII=</ImageData></EmbeddedImage></EmbeddedImages><Language>en-GB</Language><ConsumeContainerWhitespace>true</ConsumeContainerWhitespace><rd:ReportUnitType>Cm</rd:ReportUnitType><rd:ReportID>6f17c384-dc47-4cee-9f7e-463d34d72b5a</rd:ReportID></Report>