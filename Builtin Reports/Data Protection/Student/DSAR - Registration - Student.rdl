<?xml version="1.0" encoding="utf-8"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner"><Body><ReportItems><Tablix Name="Tablix1"><TablixBody><TablixColumns><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox1"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>ID</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox1</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox3"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Name</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox3</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="intPersonID"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!intPersonID.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>intPersonID</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtSurname"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtSurname.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun><TextRun><Value>, </Value><Style><FontFamily>Arial</FontFamily></Style></TextRun><TextRun><Value>=Fields!txtForename.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtSurname</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="intPersonID"><GroupExpressions><GroupExpression>=Fields!intPersonID.Value</GroupExpression></GroupExpressions></Group></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>RegistrationStudent</DataSetName><Height>1.2cm</Height><Width>5cm</Width><Style><Border><Style>None</Style></Border></Style></Tablix><Tablix Name="Tablix2"><TablixBody><TablixColumns><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox39"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Date Time</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox39</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox40"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Status</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox40</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox2"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Late</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox2</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox43"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Minutes Late</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox43</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox47"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Code</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox47</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox49"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Code Details</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox49</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox51"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Reason</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox51</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="dtRegistrationDateTime"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dtRegistrationDateTime.Value,"dd/MM/yyyy HH:mm")</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>dtRegistrationDateTime</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtRegistrationStatus"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtRegistrationStatus.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtRegistrationStatus</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox4"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=IIF(Fields!intIsIncludedInStatistics.Value=1 AND Fields!txtRegistrationStatus.Value="Present" AND Fields!intIsLate.Value = true,
"Late","")</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox4</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="intMinutesLate"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=IIF(Fields!intIsIncludedInStatistics.Value=1 AND Fields!txtRegistrationStatus.Value="Present" AND Fields!intIsLate.Value = true,
Fields!intMinutesLate.Value,
nothing)</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>intMinutesLate</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtCode"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtCode.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtCode</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtCodeName"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtCodeName.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtCodeName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtRegistrationReason"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtRegistrationReason.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtRegistrationReason</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="intRegistrationDateTimeID"><GroupExpressions><GroupExpression>=Fields!intRegistrationDateTimeID.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=Fields!dtRegistrationDateTime.Value</Value></SortExpression></SortExpressions></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>RegistrationStudent</DataSetName><Left>5cm</Left><Height>1.2cm</Height><Width>17.5cm</Width><ZIndex>1</ZIndex><Style><Border><Style>None</Style></Border></Style></Tablix><Tablix Name="Tablix3"><TablixBody><TablixColumns><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox65"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Out Of School From</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox65</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox66"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Out Of School To</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox66</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox67"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Out Of School Code</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox67</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox68"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Out Of School Code Details</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox68</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox69"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Out Of School Reason</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox69</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox70"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Out Of School Notes</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox70</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="dtOutOfSchoolStartDateTime"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dtOutOfSchoolStartDateTime.Value,"dd/MM/yyyy HH:mm")</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>dtOutOfSchoolStartDateTime</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox72"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dtOutOfSchoolEndDateTime.Value,"dd/MM/yyyy HH:mm")</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox72</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtOutOfSchoolCode"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtOutOfSchoolCode.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtOutOfSchoolCode</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtOutOfSchoolCodeName"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtOutOfSchoolCodeName.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtOutOfSchoolCodeName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtOutOfSchoolReason"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtOutOfSchoolReason.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtOutOfSchoolReason</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtOutOfSchoolNotes"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtOutOfSchoolNotes.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtOutOfSchoolNotes</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="TblRegistrationOutOfSchoolPupilsID"><GroupExpressions><GroupExpression>=Fields!TblRegistrationOutOfSchoolPupilsID.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=Fields!dtOutOfSchoolStartDateTime.Value</Value></SortExpression></SortExpressions></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>OutOfSchool</DataSetName><Left>22.5cm</Left><Height>1.2cm</Height><Width>15cm</Width><ZIndex>2</ZIndex><Style><Border><Style>None</Style></Border></Style></Tablix><Tablix Name="Tablix4"><TablixBody><TablixColumns><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox41"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit </Value><Style><FontFamily>Segoe UI</FontFamily></Style></TextRun><TextRun><Value>Registration Date Time</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox39</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox19"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit Registation Status</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox19</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox5"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit Late</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox2</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox44"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit Minutes Late</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox43</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox48"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit Registration Code</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox47</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox50"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit Registration Code Details</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox49</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox52"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit Registration Reason</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox51</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox21"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Audit Date Time</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox21</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="dtRegistrationDateTime2"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dtAuditRegistrationDateTime.Value, "dd/MM/yyyy HH:mm")</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>dtRegistrationDateTime</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtAuditStatus"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtAuditStatus.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtAuditStatus</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox6"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=IIF(Fields!blnAuditLate.Value = True, "Late", "")</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox4</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="intMinutesLate2"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=IIF(Fields!blnAuditLate.Value = True, Fields!intAuditMinutesLate.Value, Nothing)</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>intMinutesLate</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtCode2"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtAuditCode.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtCode</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtCodeName2"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtAuditCodeName.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtCodeName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtRegistrationReason2"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtAuditReason.Value</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtRegistrationReason</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="dtAuditDate"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dtAuditDate.Value,"dd/MM/yyyy HH:mm")</Value><Style><FontFamily>Arial</FontFamily></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>dtAuditDate</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="TblRegistrationSchoolRegistrationPupilsAuditID"><GroupExpressions><GroupExpression>=Fields!TblRegistrationSchoolRegistrationPupilsAuditID.Value</GroupExpression></GroupExpressions></Group><SortExpressions><SortExpression><Value>=Fields!dtAuditRegistrationDateTime.Value</Value></SortExpression><SortExpression><Value>=Fields!TblRegistrationSchoolRegistrationPupilsAuditID.Value</Value></SortExpression></SortExpressions></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>RegistrationAudit</DataSetName><Left>37.5cm</Left><Height>1.2cm</Height><Width>20cm</Width><ZIndex>3</ZIndex><Style><Border><Style>None</Style></Border></Style></Tablix></ReportItems><Height>0.47244in</Height><Style /></Body><Width>22.6378in</Width><Page><PageHeight>29.7cm</PageHeight><PageWidth>21cm</PageWidth><LeftMargin>2cm</LeftMargin><RightMargin>2cm</RightMargin><TopMargin>2cm</TopMargin><BottomMargin>2cm</BottomMargin><ColumnSpacing>0.13cm</ColumnSpacing><Style /></Page><AutoRefresh>0</AutoRefresh><DataSources><DataSource Name="iSAMS"><DataSourceReference>iSAMS</DataSourceReference><rd:SecurityType>None</rd:SecurityType><rd:DataSourceID>09c25523-b7f0-40b2-a998-41c5672584d9</rd:DataSourceID></DataSource></DataSources><DataSets><DataSet Name="RegistrationStudent"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@intPersonId"><Value>=Parameters!intPersonId.Value</Value></QueryParameter></QueryParameters><CommandText>


DECLARE @txtSchoolID AS nvarchar(max);
DECLARE @dtStartDate AS Date;



SET @txtSchoolID = (SELECT txtSchoolID FROM TblPupilManagementPupils WHERE intPersonId = @intPersonId);
SET @dtStartDate = (
SELECT top(1) TblRegistrationSchoolRegistrationDateTime.txtDateTime
FROM TblRegistrationSchoolRegistrationPupils
INNER JOIN TblRegistrationSchoolRegistrationRegister ON TblRegistrationSchoolRegistrationPupils.intRegister = TblRegistrationSchoolRegistrationRegister.TblRegistrationSchoolRegistrationRegisterID
INNER JOIN TblRegistrationSchoolRegistrationDateTime ON TblRegistrationSchoolRegistrationRegister.intRegistrationDateTime = TblRegistrationSchoolRegistrationDateTime.TblRegistrationSchoolRegistrationDateTimeID
WHERE TblRegistrationSchoolRegistrationPupils.txtSchoolID = @txtSchoolID
ORDER BY TblRegistrationSchoolRegistrationDateTime.txtDateTime ASC
);







SELECT 
--core
TblPupilManagementPupils.intPersonID,
TblPupilManagementPupils.txtSurname,
TblPupilManagementPupils.txtForename,

--Registration
Attendance.intRegistrationDateTimeID,
Attendance.intIsIncludedInStatistics,
Attendance.dtRegistrationDateTime,
Attendance.txtRegistrationStatus,
Attendance.intIsLate,
Attendance.intMinutesLate,
Attendance.txtCode,
Attendance.txtCodeName,
Attendance.txtRegistrationReason

FROM dbo.uf_Registration_AttendanceBetweenDates(@dtStartDate,DateAdd(day,1,GETDATE()),@txtSchoolID) AS Attendance
LEFT OUTER JOIN TblPupilManagementPupils ON Attendance.txtSchoolID = TblPupilManagementPupils.txtSchoolID</CommandText></Query><Fields><Field Name="intPersonID"><DataField>intPersonID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtSurname"><DataField>txtSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtForename"><DataField>txtForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intRegistrationDateTimeID"><DataField>intRegistrationDateTimeID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="intIsIncludedInStatistics"><DataField>intIsIncludedInStatistics</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="dtRegistrationDateTime"><DataField>dtRegistrationDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="txtRegistrationStatus"><DataField>txtRegistrationStatus</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="intIsLate"><DataField>intIsLate</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="intMinutesLate"><DataField>intMinutesLate</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtCode"><DataField>txtCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtCodeName"><DataField>txtCodeName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtRegistrationReason"><DataField>txtRegistrationReason</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="OutOfSchool"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@intPersonId"><Value>=Parameters!intPersonId.Value</Value></QueryParameter></QueryParameters><CommandText>SELECT 
TblPupilManagementPupils.intPersonID,
TblRegistrationOutOfSchoolPupils.TblRegistrationOutOfSchoolPupilsID,
TblRegistrationSchoolRegistrationCodes.txtCode AS txtOutOfSchoolCode,
TblRegistrationSchoolRegistrationCodes.txtName AS txtOutOfSchoolCodeName,
TblRegistrationOutOfSchoolPupils.txtReason AS txtOutOfSchoolReason,
TblRegistrationOutOfSchoolPupils.txtStartDateTime AS dtOutOfSchoolStartDateTime,
TblRegistrationOutOfSchoolPupils.txtEndDateTime AS dtOutOfSchoolEndDateTime,
TblRegistrationOutOfSchoolPupils.txtNotes AS txtOutOfSchoolNotes
FROM TblRegistrationOutOfSchoolPupils
INNER JOIN TblPupilManagementPupils ON TblRegistrationOutOfSchoolPupils.txtSchoolID = TblPupilManagementPupils.txtSchoolID 
INNER JOIN TblRegistrationSchoolRegistrationCodes ON TblRegistrationOutOfSchoolPupils.intCode = TblRegistrationSchoolRegistrationCodes.TblRegistrationSchoolRegistrationCodesID
WHERE TblPupilManagementPupils.intPersonID = @intPersonId</CommandText></Query><Fields><Field Name="intPersonID"><DataField>intPersonID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="TblRegistrationOutOfSchoolPupilsID"><DataField>TblRegistrationOutOfSchoolPupilsID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtOutOfSchoolCode"><DataField>txtOutOfSchoolCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtOutOfSchoolCodeName"><DataField>txtOutOfSchoolCodeName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtOutOfSchoolReason"><DataField>txtOutOfSchoolReason</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="dtOutOfSchoolStartDateTime"><DataField>dtOutOfSchoolStartDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="dtOutOfSchoolEndDateTime"><DataField>dtOutOfSchoolEndDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="txtOutOfSchoolNotes"><DataField>txtOutOfSchoolNotes</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="RegistrationAudit"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@intPersonId"><Value>=Parameters!intPersonId.Value</Value></QueryParameter></QueryParameters><CommandText>WITH AuditCodes AS 
(
SELECT 'Present' AS txtAuditCodeStatus, 
txtCode AS txtAuditCode, 
txtName AS txtAuditCodeName, 
TblRegistrationSchoolRegistrationPresentCodes.TblRegistrationSchoolRegistrationPresentCodesID AS intAuditCodeID, 
'Present' AS txtAuditCodeStatisticalStatus
FROM  TblRegistrationSchoolRegistrationPresentCodes

UNION ALL

SELECT 'Absent' AS txtAuditCodeStatus, 
txtCode AS txtAuditCode, 
txtName AS txtAuditCodeName, 
TblRegistrationSchoolRegistrationCodes.TblRegistrationSchoolRegistrationCodesID AS intAuditCodeID, 
CASE WHEN TblRegistrationSchoolRegistrationCodes.blnAbsence = 1 THEN 'Absent' ELSE 'Present' END AS txtAuditCodeStatisticalStatus
FROM            TblRegistrationSchoolRegistrationCodes
), 

AuditedPupilsDetails AS
(
SELECT 
TblRegistrationSchoolRegistrationPupilsAudit.TblRegistrationSchoolRegistrationPupilsAuditID,
TblRegistrationSchoolRegistrationPupilsAudit.txtSchoolID, 
TblRegistrationSchoolRegistrationPupilsAudit.intRegister,
TblRegistrationSchoolRegistrationRegister.intRegistrationDateTime,
TblRegistrationSchoolRegistrationDateTime.txtAmPm,
TblRegistrationSchoolRegistrationDateTime.txtDateTime AS dtRegistrationDateTime,
TblRegistrationSchoolRegistrationPupilsAudit.blnRegistered AS blnAuditRegistered, 
TblRegistrationSchoolRegistrationPupilsAudit.txtSubmitDateTime AS dtAuditDate, 
TblRegistrationSchoolRegistrationPupilsAudit.txtReason AS txtAuditReason, 
TblRegistrationSchoolRegistrationPupilsAudit.blnLate AS blnAuditLate, 
TblRegistrationSchoolRegistrationPupilsAudit.intMinutesLate AS intAuditMinutesLate,
CASE WHEN TblRegistrationSchoolRegistrationPupilsAudit.blnRegistered = 1 THEN 'Present' WHEN TblRegistrationSchoolRegistrationPupilsAudit.blnRegistered= 0 THEN 'Absent' ELSE 'Not Registered' END AS txtAuditStatus, 
CASE WHEN TblRegistrationSchoolRegistrationPupilsAudit.blnRegistered = 1 THEN TblRegistrationSchoolRegistrationPupilsAudit.intPresentCode WHEN TblRegistrationSchoolRegistrationPupilsAudit.blnRegistered = 0 THEN TblRegistrationSchoolRegistrationPupilsAudit.intCode ELSE NULL END AS intAuditCode
FROM TblRegistrationSchoolRegistrationPupilsAudit
INNER JOIN TblPupilManagementPupils ON TblRegistrationSchoolRegistrationPupilsAudit.txtSchoolID = TblPupilManagementPupils.txtSchoolID
INNER JOIN TblRegistrationSchoolRegistrationRegister ON TblRegistrationSchoolRegistrationPupilsAudit.intRegister = TblRegistrationSchoolRegistrationRegister.TblRegistrationSchoolRegistrationRegisterID
INNER JOIN TblRegistrationSchoolRegistrationDateTime ON TblRegistrationSchoolRegistrationRegister.intRegistrationDateTime = TblRegistrationSchoolRegistrationDateTime.TblRegistrationSchoolRegistrationDateTimeID
WHERE TblPupilManagementPupils.intPersonID = @intPersonId
)

SELECT 
--core
TblPupilManagementPupils.intPersonID,
TblPupilManagementPupils.txtSurname,
TblPupilManagementPupils.txtForename,

--Registration audit 
AuditedPupilsDetails.TblRegistrationSchoolRegistrationPupilsAuditID,
AuditedPupilsDetails.dtAuditDate,
AuditedPupilsDetails.intRegistrationDateTime AS intAuditRegistrationDateTimeID,
AuditedPupilsDetails.dtRegistrationDateTime AS dtAuditRegistrationDateTime,
AuditedPupilsDetails.txtAuditStatus,
AuditedPupilsDetails.blnAuditLate,
AuditedPupilsDetails.intAuditMinutesLate,
AuditCodes.txtAuditCode,
AuditCodes.txtAuditCodeName,
AuditedPupilsDetails.txtAuditReason
FROM AuditedPupilsDetails
INNER JOIN TblPupilManagementPupils ON AuditedPupilsDetails.txtSchoolID = TblPupilManagementPupils.txtSchoolID
LEFT OUTER JOIN AuditCodes ON AuditedPupilsDetails.txtAuditStatus = AuditCodes.txtAuditCodeStatus AND AuditedPupilsDetails.intAuditCode = AuditCodes.intAuditCodeID
</CommandText></Query><Fields><Field Name="intPersonID"><DataField>intPersonID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtSurname"><DataField>txtSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtForename"><DataField>txtForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="TblRegistrationSchoolRegistrationPupilsAuditID"><DataField>TblRegistrationSchoolRegistrationPupilsAuditID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="dtAuditDate"><DataField>dtAuditDate</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="intAuditRegistrationDateTimeID"><DataField>intAuditRegistrationDateTimeID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="dtAuditRegistrationDateTime"><DataField>dtAuditRegistrationDateTime</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="txtAuditStatus"><DataField>txtAuditStatus</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="blnAuditLate"><DataField>blnAuditLate</DataField><rd:TypeName>System.Boolean</rd:TypeName></Field><Field Name="intAuditMinutesLate"><DataField>intAuditMinutesLate</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtAuditCode"><DataField>txtAuditCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtAuditCodeName"><DataField>txtAuditCodeName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtAuditReason"><DataField>txtAuditReason</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet></DataSets><ReportParameters><ReportParameter Name="intPersonId"><DataType>String</DataType><DefaultValue><Values><Value>10877</Value></Values></DefaultValue><Prompt>Student:</Prompt></ReportParameter></ReportParameters><rd:ReportUnitType>Cm</rd:ReportUnitType><rd:ReportID>c59d5b76-daca-48bd-a551-042d4b03db8c</rd:ReportID></Report>