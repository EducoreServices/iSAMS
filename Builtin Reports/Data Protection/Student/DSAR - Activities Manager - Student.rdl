<?xml version="1.0" encoding="utf-8"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner"><Body><ReportItems><Tablix Name="Tablix1"><TablixBody><TablixColumns><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox1"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>ID</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox1</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox3"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Name</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox3</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="intPersonID"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!intPersonID.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>intPersonID</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtSurname"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtSurname.Value</Value><Style /></TextRun><TextRun><Value>, </Value><Style /></TextRun><TextRun><Value>=Fields!txtForename.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtSurname</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="intPersonID"><GroupExpressions><GroupExpression>=Fields!intPersonID.Value</GroupExpression></GroupExpressions></Group></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>Student</DataSetName><Height>1.2cm</Height><Width>5cm</Width><Style><Border><Style>None</Style></Border></Style></Tablix><Tablix Name="Tablix2"><TablixBody><TablixColumns><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox15"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Activity Name</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox15</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox7"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Activity Group Name</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox9"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Member Of The Group From</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox9</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox10"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Member Of The Group To</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox10</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="txtActivityName"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtActivityName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtActivityName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtActivityGroupName"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtActivityGroupName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtActivityGroupName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="dMemberOfTheGroupFrom"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dMemberOfTheGroupFrom.Value,"dd/MM/yyyy")</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>dMemberOfTheGroupFrom</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="dMemberOfTheGroupTo"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dMemberOfTheGroupTo.Value,"dd/MM/yyyy")</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>dMemberOfTheGroupTo</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="ActivitiesGroups" /><SortExpressions><SortExpression><Value>=Fields!txtActivityName.Value</Value></SortExpression><SortExpression><Value>=Fields!txtActivityGroupName.Value</Value></SortExpression><SortExpression><Value>=Fields!dMemberOfTheGroupFrom.Value</Value></SortExpression></SortExpressions></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>StudentActivityGroups</DataSetName><Left>5cm</Left><Height>1.2cm</Height><Width>10cm</Width><ZIndex>1</ZIndex><Style><Border><Style>None</Style></Border></Style></Tablix><Tablix Name="Tablix3"><TablixBody><TablixColumns><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn><TablixColumn><Width>2.5cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox41"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Activity Name</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox41</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox33"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Activity Group Name</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox33</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox35"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Occurrence Date</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox35</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox36"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Registration Status</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox36</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox51"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Attendance Code</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox51</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox53"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Attendance  </Value><Style /></TextRun><TextRun><Value>Code Name</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>Textbox53</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="txtActivityName1"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtActivityName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtActivityName1</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtActivityGroupName1"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtActivityGroupName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtActivityGroupName1</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="dteOccurrenceDate"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Format(Fields!dteOccurrenceDate.Value,"dd/MM/yyyy HH:mm")</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>dteOccurrenceDate</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtRegistrationStatus"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtRegistrationStatus.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtRegistrationStatus</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtAbsenceCode"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtAbsenceCode.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtAbsenceCode</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="txtAbsenceCodeName"><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!txtAbsenceCodeName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>txtAbsenceCodeName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="Registration" /><SortExpressions><SortExpression><Value>=Fields!txtActivityName.Value</Value></SortExpression><SortExpression><Value>=Fields!txtActivityGroupName.Value</Value></SortExpression><SortExpression><Value>=Fields!dteOccurrenceDate.Value</Value></SortExpression></SortExpressions></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>ActivityRegistration</DataSetName><Left>15cm</Left><Height>1.2cm</Height><Width>15cm</Width><ZIndex>2</ZIndex><Style><Border><Style>None</Style></Border></Style></Tablix></ReportItems><Height>0.47244in</Height><Style /></Body><Width>11.81102in</Width><Page><PageHeight>29.7cm</PageHeight><PageWidth>21cm</PageWidth><LeftMargin>2cm</LeftMargin><RightMargin>2cm</RightMargin><TopMargin>2cm</TopMargin><BottomMargin>2cm</BottomMargin><ColumnSpacing>0.13cm</ColumnSpacing><Style /></Page><AutoRefresh>0</AutoRefresh><DataSources><DataSource Name="iSAMS"><DataSourceReference>iSAMS</DataSourceReference><rd:SecurityType>None</rd:SecurityType><rd:DataSourceID>2de15329-ff47-48a4-b048-ac7309f7c3e6</rd:DataSourceID></DataSource></DataSources><DataSets><DataSet Name="Student"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@intPersonId"><Value>=Parameters!intPersonId.Value</Value></QueryParameter></QueryParameters><CommandText>SELECT 

--core
TblPupilManagementPupils.intPersonID,
TblPupilManagementPupils.txtSurname,
TblPupilManagementPupils.txtForename

FROM TblPupilManagementPupils
WHERE TblPupilManagementPupils.intPersonID = @intPersonId

</CommandText></Query><Fields><Field Name="intPersonID"><DataField>intPersonID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtSurname"><DataField>txtSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtForename"><DataField>txtForename</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="iSAMSAddress"><Query><DataSourceName>iSAMS</DataSourceName><CommandText>SELECT txtInternaliSAMSAddress
FROM TbliSAMSManagerSettings</CommandText></Query><Fields><Field Name="txtInternaliSAMSAddress"><DataField>txtInternaliSAMSAddress</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="StudentActivityGroups"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@intPersonId"><Value>=Parameters!intPersonId.Value</Value></QueryParameter></QueryParameters><CommandText>SELECT 

--core
TblPupilManagementPupils.intPersonID,
TblPupilManagementPupils.txtSurname,
TblPupilManagementPupils.txtForename,

--Activity

TblActivityManagerGroupPupilLink.dteStartDate AS dMemberOfTheGroupFrom,
TblActivityManagerGroupPupilLink.dteEndDate AS dMemberOfTheGroupTo,
TblActivityManagerGroup.TblActivityManagerGroupId,
TblActivityManagerGroup.txtName AS txtActivityGroupName,
TblActivityManagerActivity.txtName AS txtActivityName


FROM TblPupilManagementPupils

INNER JOIN TblActivityManagerGroupPupilLink ON TblPupilManagementPupils.txtSchoolID = TblActivityManagerGroupPupilLink.txtSchoolID
INNER JOIN TblActivityManagerGroup ON TblActivityManagerGroupPupilLink.intGroup = TblActivityManagerGroup.TblActivityManagerGroupID 
INNER JOIN TblActivityManagerActivity ON TblActivityManagerGroup.intActivity = TblActivityManagerActivity.TblActivityManagerActivityID

WHERE TblPupilManagementPupils.intPersonID = @intPersonId
</CommandText></Query><Fields><Field Name="intPersonID"><DataField>intPersonID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtSurname"><DataField>txtSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtForename"><DataField>txtForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="dMemberOfTheGroupFrom"><DataField>dMemberOfTheGroupFrom</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="dMemberOfTheGroupTo"><DataField>dMemberOfTheGroupTo</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="TblActivityManagerGroupId"><DataField>TblActivityManagerGroupId</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtActivityGroupName"><DataField>txtActivityGroupName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtActivityName"><DataField>txtActivityName</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="ActivityRegistration"><Query><DataSourceName>iSAMS</DataSourceName><QueryParameters><QueryParameter Name="@intPersonId"><Value>=Parameters!intPersonId.Value</Value></QueryParameter></QueryParameters><CommandText>SELECT        
--core
TblPupilManagementPupils.intPersonID,
TblPupilManagementPupils.txtSurname,
TblPupilManagementPupils.txtForename,

--attendance
TblActivityManagerGroup.txtName AS txtActivityGroupName,
TblActivityManagerActivity.txtName AS txtActivityName,

TblActivityManagerEventOccurrence.dteOccurrenceDate,
CASE WHEN TblActivityManagerRegistrationPupils.blnPresent = 1 THEN 'Present'
WHEN TblActivityManagerRegistrationPupils.blnPresent = 0 THEN 'Absent'
ELSE 'Not Registered' END AS txtRegistrationStatus,
TblActivityManagerRegistrationCode.txtCode AS txtAbsenceCode,
TblActivityManagerRegistrationCode.txtName AS txtAbsenceCodeName

FROM TblPupilManagementPupils 
INNER JOIN TblActivityManagerGroupPupilLink ON TblPupilManagementPupils.txtSchoolID = TblActivityManagerGroupPupilLink.txtSchoolID 
INNER JOIN TblActivityManagerGroup ON TblActivityManagerGroup.TblActivityManagerGroupId = TblActivityManagerGroupPupilLink.intGroup 
INNER JOIN TblActivityManagerActivity ON TblActivityManagerGroup.intActivity = TblActivityManagerActivity.TblActivityManagerActivityId 
INNER JOIN TblActivityManagerEvent ON TblActivityManagerGroup.TblActivityManagerGroupId = TblActivityManagerEvent.intGroup 
INNER JOIN TblActivityManagerEventOccurrence ON TblActivityManagerEvent.TblActivityManagerEventId = TblActivityManagerEventOccurrence.intEventId 
INNER JOIN TblActivityManagerEventPupilLink ON TblActivityManagerEvent.TblActivityManagerEventId = TblActivityManagerEventPupilLink.intEventId 
AND TblActivityManagerEventPupilLink.txtSchoolId = TblPupilManagementPupils.txtschoolID
INNER JOIN TblActivityManagerRegistrationPupils ON TblActivityManagerEventOccurrence.TblActivityManagerEventOccurrenceId = TblActivityManagerRegistrationPupils.intEventOccurrence
AND TblActivityManagerEventPupilLink.TblEventPupilLinkId = TblActivityManagerRegistrationPupils.intEventPupilLink
LEFT OUTER JOIN TblActivityManagerRegistrationCode ON TblActivityManagerRegistrationPupils.intRegistrationCode = TblActivityManagerRegistrationCode.TblActivityManagerRegistrationCodeID
WHERE TblPupilManagementPupils.intPersonID = @intPersonId

</CommandText></Query><Fields><Field Name="intPersonID"><DataField>intPersonID</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="txtSurname"><DataField>txtSurname</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtForename"><DataField>txtForename</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtActivityGroupName"><DataField>txtActivityGroupName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtActivityName"><DataField>txtActivityName</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="dteOccurrenceDate"><DataField>dteOccurrenceDate</DataField><rd:TypeName>System.DateTime</rd:TypeName></Field><Field Name="txtRegistrationStatus"><DataField>txtRegistrationStatus</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtAbsenceCode"><DataField>txtAbsenceCode</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="txtAbsenceCodeName"><DataField>txtAbsenceCodeName</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet></DataSets><ReportParameters><ReportParameter Name="intPersonId"><DataType>String</DataType><DefaultValue><Values><Value>49765</Value></Values></DefaultValue><Prompt>Student:</Prompt></ReportParameter></ReportParameters><rd:ReportUnitType>Cm</rd:ReportUnitType><rd:ReportID>ce8b9b7a-051f-4ae5-80cc-7d74a8bebc08</rd:ReportID></Report>