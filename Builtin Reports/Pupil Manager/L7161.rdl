<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="iSAMS">
      <DataSourceReference>iSAMS</DataSourceReference>
      <rd:DataSourceID>afcb3ec8-8016-45dd-9343-1ca1e6b82d39</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <BottomMargin>0cm</BottomMargin>
  <RightMargin>0.5cm</RightMargin>
  <PageWidth>21cm</PageWidth>
  <ReportParameters>
    <ReportParameter Name="Status">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <Prompt>Status</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>1</Value>
            <Label>Current Pupils</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>0</Value>
            <Label>Prospective Pupils</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>-1</Value>
            <Label>Past Pupils</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="Form">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>FormsDDL</DataSetName>
          <ValueField>FormValue</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Form</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>FormsDDL</DataSetName>
          <ValueField>FormValue</ValueField>
          <LabelField>FormLabel</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="Correspondence">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <Values>
          <Value>1</Value>
        </Values>
      </DefaultValue>
      <Prompt>Contacts</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>1</Value>
            <Label>Correspondence Contacts</Label>
          </ParameterValue>
          <ParameterValue>
            <Label>All Contacts</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="YearGroup">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>YearGroupDDL</DataSetName>
          <ValueField>YearGroupValue</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Year Group</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>YearGroupDDL</DataSetName>
          <ValueField>YearGroupValue</ValueField>
          <LabelField>YearGroupLabel</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="AddressType">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>AddressTypeSelect</DataSetName>
          <ValueField>NameValue</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Address Type</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>AddressTypeDDL</DataSetName>
          <ValueField>NameValue</ValueField>
          <LabelField>NameLabel</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="House">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>HouseDDL</DataSetName>
          <ValueField>HouseValue</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>House</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>HouseDDL</DataSetName>
          <ValueField>HouseValue</ValueField>
          <LabelField>HouseLabel</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="SortedBy">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>P</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>Sorted By</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>P</Value>
            <Label>Pupil</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>HP</Value>
            <Label>House then Pupil</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>FP</Value>
            <Label>Form then Pupil</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>YP</Value>
            <Label>Year then Pupil</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="Relation">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>RelationDDL</DataSetName>
          <ValueField>NameValue</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Relation</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>RelationDDL</DataSetName>
          <ValueField>NameValue</ValueField>
          <LabelField>NameLabel</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>21cm</InteractiveWidth>
  <rd:GridSpacing>0.1cm</rd:GridSpacing>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <Body>
    <ColumnSpacing>0.2cm</ColumnSpacing>
    <Columns>3</Columns>
    <ReportItems>
      <List Name="list2">
        <Sorting>
          <SortBy>
            <SortExpression>=iif(Parameters!SortedBy.Value="FP",Fields!txtForm.Value,iif(Parameters!SortedBy.Value="HP",Fields!txtBoardingHouse.Value,iif(Parameters!SortedBy.Value="YP",Fields!intNCYear.Value,Fields!PupilDisplayName.Value)))</SortExpression>
            <Direction>Ascending</Direction>
          </SortBy>
          <SortBy>
            <SortExpression>=Fields!PupilDisplayName.Value</SortExpression>
            <Direction>Ascending</Direction>
          </SortBy>
        </Sorting>
        <ReportItems>
          <Textbox Name="textbox1">
            <Top>0.03937in</Top>
            <rd:DefaultName>textbox1</rd:DefaultName>
            <Width>2.32313in</Width>
            <Style>
              <TextAlign>Left</TextAlign>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingBottom>2pt</PaddingBottom>
              <FontSize>9pt</FontSize>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
            </Style>
            <CanGrow>true</CanGrow>
            <Height>1.69312in</Height>
            <Value>=trim(Fields!txtJointLabelSalutation.Value) &amp; chr(13) &amp; chr(10) &amp; trim(Fields!txtAddress1.Value) &amp; iif(trim(Fields!txtAddress2.Value)&lt;&gt;"",chr(13) &amp; chr(10) &amp; trim(Fields!txtAddress2.Value),"") &amp; iif(trim(Fields!txtAddress3.Value)&lt;&gt;"",chr(13) &amp; chr(10) &amp; trim(Fields!txtAddress3.Value),"") &amp; iif(trim(Fields!txtTown.Value)&lt;&gt;"",chr(13) &amp; chr(10) &amp; trim(Fields!txtTown.Value),"") &amp; iif(trim(Fields!txtCounty.Value)&lt;&gt;"",chr(13) &amp; chr(10) &amp; trim(Fields!txtCounty.Value),"") &amp; iif(trim(Fields!txtCountry.Value)&lt;&gt;"",chr(13) &amp; chr(10) &amp; trim(Fields!txtCountry.Value),"") &amp; iif(trim(Fields!txtPostcode.Value)&lt;&gt;"",chr(13) &amp; chr(10) &amp; trim(Fields!txtPostcode.Value),"")</Value>
          </Textbox>
        </ReportItems>
        <DataSetName>PupilContactDS</DataSetName>
        <Top>0.03937in</Top>
        <Width>2.44125in</Width>
        <Height>1.85062in</Height>
      </List>
    </ReportItems>
    <Height>2.16562in</Height>
  </Body>
  <PageHeader>
    <Height>0.03937in</Height>
    <PrintOnLastPage>true</PrintOnLastPage>
    <PrintOnFirstPage>true</PrintOnFirstPage>
  </PageHeader>
  <rd:ReportID>eecb2c22-2421-4586-b8ce-4cd2150f9f98</rd:ReportID>
  <LeftMargin>0.7cm</LeftMargin>
  <DataSets>
    <DataSet Name="YearGroupDDL">
      <Query>
        <CommandText>SELECT        intNCYear AS YearGroupValue, CONVERT(varchar, intNCYear) AS YearGroupLabel
FROM            TblSchoolManagementYears
WHERE        (intNCYear &gt; 0)
UNION
SELECT        NULL AS YearGroupValue, 'Any' AS YearGroupLabel
ORDER BY YearGroupValue</CommandText>
        <DataSourceName>iSAMS</DataSourceName>
      </Query>
      <Fields>
        <Field Name="YearGroupValue">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>YearGroupValue</DataField>
        </Field>
        <Field Name="YearGroupLabel">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>YearGroupLabel</DataField>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="PupilContactDS">
      <Query>
        <CommandText>SELECT        TblPupilManagementPupils.intSystemStatus, TblPupilManagementPupils.txtForename, TblPupilManagementPupils.txtSurname, 
                         TblPupilManagementPupils.txtPreName, TblPupilManagementPupils.intNCYear, TblPupilManagementPupils.txtForm, 
                         TblPupilManagementPupils.txtBoardingHouse, TblPupilManagementAddresses.txtAddressType, TblPupilManagementAddresses.txtRelationType, 
                         TblPupilManagementAddresses.intJustContact, TblPupilManagementAddresses.intMailMergeAll, TblPupilManagementAddresses.intBillingMailMerge, 
                         TblPupilManagementAddresses.intCorrespondenceMailMerge, TblPupilManagementAddresses.intReportsMailMerge, 
                         TblPupilManagementAddresses.txtAddress1, TblPupilManagementAddresses.txtAddress2, TblPupilManagementAddresses.txtAddress3, 
                         TblPupilManagementAddresses.txtCounty, TblPupilManagementAddresses.txtCountry, TblPupilManagementAddresses.txtPostcode, 
                         TblPupilManagementAddresses.txtFax, TblPupilManagementAddresses.txtJointLabelSalutation, TblPupilManagementAddresses.txtTown
FROM            TblPupilManagementAddressLink INNER JOIN
                         TblPupilManagementPupils ON TblPupilManagementAddressLink.txtSchoolID = TblPupilManagementPupils.txtSchoolID INNER JOIN
                         TblPupilManagementAddresses ON 
                         TblPupilManagementAddressLink.intAddressID = TblPupilManagementAddresses.TblPupilManagementAddressesID
WHERE        (TblPupilManagementPupils.intSystemStatus = @Status) AND (TblPupilManagementPupils.txtBoardingHouse = @House OR
                         @House IS NULL) AND (TblPupilManagementPupils.intNCYear = @YearGroup OR
                         @YearGroup IS NULL) AND (TblPupilManagementPupils.txtForm = @Form OR
                         @Form IS NULL) AND (TblPupilManagementAddresses.txtAddressType IN (@AddressType)) AND 
                         (TblPupilManagementAddresses.txtRelationType = @Relation OR
                         @Relation IS NULL) AND (TblPupilManagementAddresses.intCorrespondenceMailMerge = @Correspondence OR
                         @Correspondence IS NULL) AND (TblPupilManagementAddresses.txtJointLabelSalutation &lt;&gt; '""') AND 
                         (TblPupilManagementAddresses.txtJointLabelSalutation IS NOT NULL)</CommandText>
        <QueryParameters>
          <QueryParameter Name="@Status">
            <Value>=Parameters!Status.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@House">
            <Value>=Parameters!House.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@YearGroup">
            <Value>=Parameters!YearGroup.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Form">
            <Value>=Parameters!Form.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@AddressType">
            <Value>=Parameters!AddressType.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Relation">
            <Value>=Parameters!Relation.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Correspondence">
            <Value>=Parameters!Correspondence.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <DataSourceName>iSAMS</DataSourceName>
      </Query>
      <Fields>
        <Field Name="intSystemStatus">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>intSystemStatus</DataField>
        </Field>
        <Field Name="txtForename">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtForename</DataField>
        </Field>
        <Field Name="txtSurname">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtSurname</DataField>
        </Field>
        <Field Name="txtPreName">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtPreName</DataField>
        </Field>
        <Field Name="intNCYear">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>intNCYear</DataField>
        </Field>
        <Field Name="txtForm">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtForm</DataField>
        </Field>
        <Field Name="txtBoardingHouse">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtBoardingHouse</DataField>
        </Field>
        <Field Name="txtAddressType">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtAddressType</DataField>
        </Field>
        <Field Name="txtRelationType">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtRelationType</DataField>
        </Field>
        <Field Name="intJustContact">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>intJustContact</DataField>
        </Field>
        <Field Name="intMailMergeAll">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>intMailMergeAll</DataField>
        </Field>
        <Field Name="intBillingMailMerge">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>intBillingMailMerge</DataField>
        </Field>
        <Field Name="intCorrespondenceMailMerge">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>intCorrespondenceMailMerge</DataField>
        </Field>
        <Field Name="intReportsMailMerge">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>intReportsMailMerge</DataField>
        </Field>
        <Field Name="txtAddress1">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtAddress1</DataField>
        </Field>
        <Field Name="txtAddress2">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtAddress2</DataField>
        </Field>
        <Field Name="txtAddress3">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtAddress3</DataField>
        </Field>
        <Field Name="txtCounty">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtCounty</DataField>
        </Field>
        <Field Name="txtCountry">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtCountry</DataField>
        </Field>
        <Field Name="txtPostcode">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtPostcode</DataField>
        </Field>
        <Field Name="txtFax">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtFax</DataField>
        </Field>
        <Field Name="txtJointLabelSalutation">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtJointLabelSalutation</DataField>
        </Field>
        <Field Name="txtTown">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>txtTown</DataField>
        </Field>
        <Field Name="PupilDisplayName">
          <Value>=Fields!txtSurname.Value &amp; ", " &amp; Fields!txtPreName.Value</Value>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="FormsDDL">
      <Query>
        <CommandText>SELECT        txtForm AS FormLabel, txtForm AS FormValue, CONVERT(int, LEFT(txtForm, LEN(txtForm) - 1)) AS FormSort
FROM            TblSchoolManagementForms
UNION
SELECT        'Any' AS FormLabel, NULL AS FormValue, 0 AS FormSort
ORDER BY FormSort</CommandText>
        <DataSourceName>iSAMS</DataSourceName>
      </Query>
      <Fields>
        <Field Name="FormLabel">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>FormLabel</DataField>
        </Field>
        <Field Name="FormValue">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>FormValue</DataField>
        </Field>
        <Field Name="FormSort">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>FormSort</DataField>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="HouseDDL">
      <Query>
        <CommandText>SELECT        txtHouseName AS HouseValue, txtHouseName AS HouseLabel
FROM            TblSchoolManagementHouses
WHERE        (txtHouseType = N'Boarding')
UNION
SELECT        NULL AS HouseValue, 'Any' AS HouseLabel
ORDER BY HouseValue</CommandText>
        <DataSourceName>iSAMS</DataSourceName>
      </Query>
      <Fields>
        <Field Name="HouseValue">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>HouseValue</DataField>
        </Field>
        <Field Name="HouseLabel">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>HouseLabel</DataField>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="RelationDDL">
      <Query>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
        <CommandText>SELECT        Name AS NameValue, Name AS NameLabel
FROM            TblUsefulLists
WHERE        (ListType = N'ContactType')
UNION
SELECT        NULL AS NameValue, 'Any' AS NameLabel
ORDER BY NameValue</CommandText>
        <DataSourceName>iSAMS</DataSourceName>
      </Query>
      <Fields>
        <Field Name="NameValue">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>NameValue</DataField>
        </Field>
        <Field Name="NameLabel">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>NameLabel</DataField>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="AddressTypeDDL">
      <Query>
        <CommandText>SELECT        Name AS NameValue, Name AS NameLabel
FROM            TblUsefulLists
WHERE        (ListType = N'AddressType')
ORDER BY NameValue</CommandText>
        <DataSourceName>iSAMS</DataSourceName>
      </Query>
      <Fields>
        <Field Name="NameValue">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>NameValue</DataField>
        </Field>
        <Field Name="NameLabel">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>NameLabel</DataField>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="AddressTypeSelect">
      <Query>
        <CommandText>SELECT        Name AS NameValue, Name AS NameLabel
FROM            TblUsefulLists
WHERE        (ListType = N'AddressType')
ORDER BY NameValue</CommandText>
        <DataSourceName>iSAMS</DataSourceName>
      </Query>
      <Fields>
        <Field Name="NameValue">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>NameValue</DataField>
        </Field>
        <Field Name="NameLabel">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>NameLabel</DataField>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <Code />
  <Width>2.48062in</Width>
  <InteractiveHeight>29.5cm</InteractiveHeight>
  <Language>en-GB</Language>
  <TopMargin>1cm</TopMargin>
  <PageHeight>29.5cm</PageHeight>
</Report>