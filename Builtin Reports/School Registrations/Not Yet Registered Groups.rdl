<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="iSAMS">
      <rd:DataSourceID>772c9ca1-961d-4a29-94df-9e6b84f683fc</rd:DataSourceID>
      <DataSourceReference>iSAMS</DataSourceReference>
    </DataSource>
  </DataSources>
  <InteractiveHeight>29.7cm</InteractiveHeight>
  <ReportParameters>
    <ReportParameter Name="txtTime">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>txtTime</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtGroupBy">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>txtGroupBy</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtStartDate">
      <DataType>DateTime</DataType>
      <Prompt>txtStartDate</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtEndDate">
      <DataType>DateTime</DataType>
      <Prompt>txtEndDate</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtSchoolID">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>txtSchoolID</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtForm">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>txtForm</Prompt>
    </ReportParameter>
    <ReportParameter Name="intNCYear">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>intNCYear</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtAcademicHouse">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>txtAcademicHouse</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtBoardingHouse">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>txtBoardingHouse</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtCustomGroups">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>txtCustomGroups</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>21cm</InteractiveWidth>
  <rd:GridSpacing>0.25cm</rd:GridSpacing>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <RightMargin>1cm</RightMargin>
  <LeftMargin>1cm</LeftMargin>
  <PageHeader>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <ReportItems>
      <Textbox Name="textbox5">
        <Style>
          <BorderStyle>
            <Bottom>Solid</Bottom>
          </BorderStyle>
          <BorderWidth>
            <Default>2pt</Default>
          </BorderWidth>
          <FontSize>12pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Right</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
          <Language>en-GB</Language>
        </Style>
        <ZIndex>1</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>10cm</Left>
        <Height>0.6cm</Height>
        <Value>=Format(CDate(Parameters!txtStartDate.value),"dd/MM/yyyy").ToString  +  IIF(Format(CDate(Parameters!txtStartDate.value),"dd/MM/yyyy")=Format(CDate(Parameters!txtEndDate.Value),"dd/MM/yyyy"),""," - " + Format(CDate(Parameters!txtEndDate.Value),"dd/MM/yyyy").ToString) + IIF(isNothing(Parameters!txtTime.Value),""," " + Parameters!txtTime.Value)</Value>
      </Textbox>
      <Textbox Name="textbox31">
        <rd:DefaultName>textbox31</rd:DefaultName>
        <Width>10cm</Width>
        <Style>
          <BorderStyle>
            <Bottom>Solid</Bottom>
          </BorderStyle>
          <BorderWidth>
            <Default>2pt</Default>
          </BorderWidth>
          <FontSize>12pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Left</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
          <Language>en-GB</Language>
        </Style>
        <CanGrow>true</CanGrow>
        <Height>0.6cm</Height>
        <Value>="Not Yet Registered Groups"</Value>
      </Textbox>
    </ReportItems>
    <Height>0.95cm</Height>
    <PrintOnLastPage>true</PrintOnLastPage>
  </PageHeader>
  <BottomMargin>0.5cm</BottomMargin>
  <rd:ReportID>36d3aa52-5785-466c-9dda-a872ad57105f</rd:ReportID>
  <PageWidth>21cm</PageWidth>
  <DataSets>
    <DataSet Name="Main">
      <Fields>
        <Field Name="TblRegistrationSchoolRegistrationDateTimeID">
          <DataField>TblRegistrationSchoolRegistrationDateTimeID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="txtDateTime">
          <DataField>txtDateTime</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="txtSubmitBy">
          <DataField>txtSubmitBy</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtSchoolID">
          <DataField>txtSchoolID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtSurname">
          <DataField>txtSurname</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtPreName">
          <DataField>txtPreName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtDOB">
          <DataField>txtDOB</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="txtForename">
          <DataField>txtForename</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtForm">
          <DataField>txtForm</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="intNCYear">
          <DataField>intNCYear</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="txtAcademicHouse">
          <DataField>txtAcademicHouse</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtBoardingHouse">
          <DataField>txtBoardingHouse</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="blnRegistered">
          <DataField>blnRegistered</DataField>
          <rd:TypeName>System.Boolean</rd:TypeName>
        </Field>
        <Field Name="txtTime">
          <DataField>txtTime</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtReason">
          <DataField>txtReason</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="blnLate">
          <DataField>blnLate</DataField>
          <rd:TypeName>System.Boolean</rd:TypeName>
        </Field>
        <Field Name="intMinutesLate">
          <DataField>intMinutesLate</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Expr1">
          <DataField>Expr1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="OOStxtSchoolID">
          <DataField>OOStxtSchoolID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtRegistrationStatus">
          <DataField>txtRegistrationStatus</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Initials">
          <DataField>Initials</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Surname">
          <DataField>Surname</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Firstname">
          <DataField>Firstname</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtTutor">
          <DataField>txtTutor</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>iSAMS</DataSourceName>
        <CommandText>SELECT        TblRegistrationSchoolRegistrationDateTime.TblRegistrationSchoolRegistrationDateTimeID, TblRegistrationSchoolRegistrationDateTime.txtDateTime, 
                         TblRegistrationSchoolRegistrationPupils.txtSubmitBy, TblRegistrationSchoolRegistrationPupils.txtSchoolID, TblPupilManagementPupils.txtSurname, 
                         TblPupilManagementPupils.txtPreName, TblPupilManagementPupils.txtDOB, TblPupilManagementPupils.txtForename, TblPupilManagementPupils.txtForm, 
                         TblPupilManagementPupils.intNCYear, TblPupilManagementPupils.txtAcademicHouse, TblPupilManagementPupils.txtBoardingHouse, 
                         TblRegistrationSchoolRegistrationPupils.blnRegistered, LEFT(CONVERT(varchar(8), TblRegistrationSchoolRegistrationDateTime.txtDateTime, 108), 5) AS txtTime, 
                         TblRegistrationSchoolRegistrationPupils.txtReason, TblRegistrationSchoolRegistrationPupils.blnLate, TblRegistrationSchoolRegistrationPupils.intMinutesLate, 
                         TblRegistrationSchoolRegistrationPupils.txtSubmitBy AS Expr1, TblRegistrationOutOfSchoolPupils.txtSchoolID AS OOStxtSchoolID, 
                         CASE WHEN TblRegistrationOutOfSchoolPupils.txtSchoolID IS NOT NULL AND (TblRegistrationSchoolRegistrationPupils.blnRegistered &lt;&gt; 1) 
                         THEN 'Absent' ELSE CASE WHEN (TblRegistrationSchoolRegistrationPupils.txtSubmitBy IS NOT NULL AND 
                         TblRegistrationSchoolRegistrationPupils.blnRegistered = 0) THEN 'Absent' WHEN (TblRegistrationSchoolRegistrationPupils.blnRegistered = 1) AND 
                         TblRegistrationSchoolRegistrationPupils.txtSubmitBy IS NOT NULL THEN 'Present' ELSE 'Not Registered' END END AS txtRegistrationStatus, TblStaff.Initials, 
                         TblStaff.Surname, TblStaff.Firstname, TblPupilManagementPupils.txtTutor
FROM            TblRegistrationSchoolRegistrationDateTime INNER JOIN
                         TblRegistrationSchoolRegistrationRegister ON 
                         TblRegistrationSchoolRegistrationRegister.intRegistrationDateTime = TblRegistrationSchoolRegistrationDateTime.TblRegistrationSchoolRegistrationDateTimeID INNER
                          JOIN
                         TblRegistrationSchoolRegistrationPupils ON 
                         TblRegistrationSchoolRegistrationPupils.intRegister = TblRegistrationSchoolRegistrationRegister.TblRegistrationSchoolRegistrationRegisterID INNER JOIN
                         TblPupilManagementPupils ON TblRegistrationSchoolRegistrationPupils.txtSchoolID = TblPupilManagementPupils.txtSchoolID LEFT OUTER JOIN
                         TblRegistrationOutOfSchoolPupils ON TblRegistrationOutOfSchoolPupils.txtSchoolID = TblPupilManagementPupils.txtSchoolID AND 
                         TblRegistrationSchoolRegistrationDateTime.txtDateTime BETWEEN TblRegistrationOutOfSchoolPupils.txtStartDateTime AND 
                         TblRegistrationOutOfSchoolPupils.txtEndDateTime LEFT OUTER JOIN
                         TblStaff ON TblPupilManagementPupils.txtTutor = TblStaff.User_Code
WHERE        (TblPupilManagementPupils.txtForm IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtForm) AS SplitCSV_1) OR
                         @txtForm IS NULL) AND (TblPupilManagementPupils.intNCYear IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@intNCYear) AS SplitCSV_1) OR
                         @intNCYear IS NULL) AND (TblPupilManagementPupils.txtAcademicHouse IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtAcademicHouse) AS SplitCSV_1) OR
                         @txtAcademicHouse IS NULL) AND (TblPupilManagementPupils.txtBoardingHouse IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtBoardingHouse) AS SplitCSV_1) OR
                         @txtBoardingHouse IS NULL) AND (LEFT(CONVERT(varchar(8), TblRegistrationSchoolRegistrationDateTime.txtDateTime, 108), 5) IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtTime) AS SplitCSV_1) OR
                         @txtTime IS NULL) AND (TblPupilManagementPupils.txtSchoolID IN
                             (SELECT        ID
                               FROM            dbo.SplitCSV(@txtSchoolID) AS SplitCSV_1) OR
                         @txtSchoolID IS NULL) AND (TblRegistrationSchoolRegistrationDateTime.txtDateTime BETWEEN @txtStartDate AND @txtEndDate) AND 
                         (TblPupilManagementPupils.txtSchoolID IN
                             (SELECT DISTINCT txtSchoolID
                               FROM            TblPupilManagementSelectionsStudents
                               WHERE        (ISNULL(intDeleted, 0) &lt;&gt; 1) AND (intSelectionID IN
                                                             (SELECT        ID
                                                               FROM            dbo.SplitCSV(@txtCustomGroups) AS SplitCSV_1))) OR
                         @txtCustomGroups IS NULL) AND ((CASE WHEN (TblPupilManagementPupils.intSystemStatus = 1 AND 
                         (TblRegistrationSchoolRegistrationDateTime.txtDateTime &gt;= TblPupilManagementPupils.txtEnrolmentDate OR
                         TblPupilManagementPupils.txtEnrolmentDate IS NULL) AND 
                         (TblRegistrationSchoolRegistrationDateTime.txtDateTime &lt;= TblPupilManagementPupils.txtLeavingDate OR
                         TblPupilManagementPupils.txtLeavingDate IS NULL)) THEN 'Yes' WHEN (TblPupilManagementPupils.intSystemStatus = - 1 AND 
                         (TblRegistrationSchoolRegistrationDateTime.txtDateTime &gt;= TblPupilManagementPupils.txtEnrolmentDate OR
                         TblPupilManagementPupils.txtEnrolmentDate IS NULL) AND TblRegistrationSchoolRegistrationDateTime.txtDateTime &lt;= TblPupilManagementPupils.txtLeavingDate) 
                         THEN 'Yes' ELSE 'No' END) = 'Yes') AND (CASE WHEN TblRegistrationOutOfSchoolPupils.txtSchoolID IS NOT NULL AND 
                         (TblRegistrationSchoolRegistrationPupils.blnRegistered &lt;&gt; 1) THEN 'Absent' ELSE CASE WHEN (TblRegistrationSchoolRegistrationPupils.txtSubmitBy IS NOT NULL 
                         AND TblRegistrationSchoolRegistrationPupils.blnRegistered = 0) THEN 'Absent' WHEN (TblRegistrationSchoolRegistrationPupils.blnRegistered = 1) AND 
                         TblRegistrationSchoolRegistrationPupils.txtSubmitBy IS NOT NULL THEN 'Present' ELSE 'Not Registered' END END = 'Not Registered')</CommandText>
        <QueryParameters>
          <QueryParameter Name="@txtForm">
            <Value>=Parameters!txtForm.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@intNCYear">
            <Value>=Parameters!intNCYear.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtAcademicHouse">
            <Value>=Parameters!txtAcademicHouse.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtBoardingHouse">
            <Value>=Parameters!txtBoardingHouse.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtTime">
            <Value>=Parameters!txtTime.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtSchoolID">
            <Value>=Parameters!txtSchoolID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtStartDate">
            <Value>=Parameters!txtStartDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtEndDate">
            <Value>=Parameters!txtEndDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtCustomGroups">
            <Value>=Parameters!txtCustomGroups.Value</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
    </DataSet>
  </DataSets>
  <Code>Public PupilCount AS  integer =0
Public AllPupilCount AS  integer =0
Public RecordCount AS integer = 0
Public SchoolID As String =""
Public PresentCodes As String =""
Public AbsentCodes As String =""

Public Function GetPresentCodes(txtCode)
if PresentCodes ="" then
PresentCodes = txtCode
else
PresentCodes = PresentCodes + "," + txtCode
end if
End Function

Public Function GetAbsentCodes(txtCode)
if AbsentCodes ="" then
AbsentCodes = txtCode
else
AbsentCodes = AbsentCodes + "," + txtCode
end if

End Function

Public Function CountPupils(ByVal txtID As String)

PupilCount = PupilCount + 1
AllPupilCount = AllPupilCount + 1

Return PupilCount 
End Function

Public Function ResetCount()
PupilCount = 0

End Function

</Code>
  <Width>19cm</Width>
  <Body>
    <ColumnSpacing>1cm</ColumnSpacing>
    <ReportItems>
      <Table Name="table2">
        <DataSetName>Main</DataSetName>
        <TableGroups>
          <TableGroup>
            <Grouping Name="table2_Group3">
              <GroupExpressions>
                <GroupExpression>=Fields!txtDateTime.Value</GroupExpression>
              </GroupExpressions>
              <PageBreakAtStart>true</PageBreakAtStart>
            </Grouping>
            <Sorting>
              <SortBy>
                <SortExpression>=Fields!txtDateTime.Value</SortExpression>
                <Direction>Ascending</Direction>
              </SortBy>
            </Sorting>
            <Header>
              <TableRows>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ColSpan>2</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox17">
                          <rd:DefaultName>textbox17</rd:DefaultName>
                          <Style>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>1pt</PaddingTop>
                            <PaddingBottom>1pt</PaddingBottom>
                          </Style>
                          <ZIndex>7</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Format(Fields!txtDateTime.Value,"dd/MM/yyyy") + " " + Fields!txtTime.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox45">
                          <rd:DefaultName>textbox45</rd:DefaultName>
                          <Style>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Right</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>1pt</PaddingTop>
                            <PaddingBottom>1pt</PaddingBottom>
                          </Style>
                          <ZIndex>6</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Not Yet Registered</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.5cm</Height>
                </TableRow>
              </TableRows>
            </Header>
            <Footer>
              <TableRows>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox26">
                          <rd:DefaultName>textbox26</rd:DefaultName>
                          <Style>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>2</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox27">
                          <rd:DefaultName>textbox27</rd:DefaultName>
                          <Style>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Right</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>1pt</PaddingTop>
                            <PaddingBottom>1pt</PaddingBottom>
                          </Style>
                          <ZIndex>1</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>="Total:"</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox35">
                          <Style>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>1pt</PaddingTop>
                            <PaddingBottom>1pt</PaddingBottom>
                          </Style>
                          <CanGrow>true</CanGrow>
                          <Value>=CountDistinct(Fields!txtSchoolID.Value).ToString</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.5cm</Height>
                </TableRow>
              </TableRows>
            </Footer>
          </TableGroup>
          <TableGroup>
            <Grouping Name="table2_Group1">
              <GroupExpressions>
                <GroupExpression>=IIF(Parameters!txtGroupBy.Value = "txtSurname",Fields!txtSchoolID.Value,Fields(Parameters!txtGroupBy.Value).value)</GroupExpression>
              </GroupExpressions>
            </Grouping>
            <Sorting>
              <SortBy>
                <SortExpression>=IIF(Parameters!txtGroupBy.Value.ToString = "txtDateTime",(Format(Fields(Parameters!txtGroupBy.Value).value,"dd/MM/yyyy") + " " + Fields!txtTime.Value),IIF(Parameters!txtGroupBy.Value = "txtSurname",Fields!txtSurname.Value + ", " + Fields!txtPreName.Value,IIF(Parameters!txtGroupBy.Value = "txtTutor",Fields!Surname.Value + ", " + Fields!Firstname.Value,Fields(Parameters!txtGroupBy.Value).value)))</SortExpression>
                <Direction>Ascending</Direction>
              </SortBy>
            </Sorting>
            <Header>
              <TableRows>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox2">
                          <rd:DefaultName>textbox2</rd:DefaultName>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>5</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox8">
                          <rd:DefaultName>textbox8</rd:DefaultName>
                          <Style>
                            <TextAlign>Left</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>1pt</PaddingTop>
                            <PaddingBottom>1pt</PaddingBottom>
                          </Style>
                          <ZIndex>4</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=IIF(Parameters!txtGroupBy.Value.ToString = "txtDateTime",(Format(Fields(Parameters!txtGroupBy.Value).value,"dd/MM/yyyy") + " " + Fields!txtTime.Value),IIF(Parameters!txtGroupBy.Value = "txtSurname",Fields!txtSurname.Value + ", " + Fields!txtPreName.Value,IIF(Parameters!txtGroupBy.Value = "txtTutor",Fields!Surname.Value + ", " + Fields!Firstname.Value,Fields(Parameters!txtGroupBy.Value).value)))</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox16">
                          <rd:DefaultName>textbox16</rd:DefaultName>
                          <Style>
                            <TextAlign>Right</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>1pt</PaddingTop>
                            <PaddingBottom>1pt</PaddingBottom>
                          </Style>
                          <ZIndex>3</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=CountDistinct(Fields!txtSchoolID.Value).ToString</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.5cm</Height>
                </TableRow>
              </TableRows>
            </Header>
          </TableGroup>
        </TableGroups>
        <TableColumns>
          <TableColumn>
            <Width>0.5cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>15cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>3.5cm</Width>
          </TableColumn>
        </TableColumns>
      </Table>
    </ReportItems>
    <Height>1.5cm</Height>
  </Body>
  <Language>en-GB</Language>
  <PageFooter>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <ReportItems>
      <Textbox Name="textbox1">
        <Top>0.25cm</Top>
        <Style>
          <BorderStyle>
            <Top>Solid</Top>
          </BorderStyle>
          <BorderWidth>
            <Default>2pt</Default>
          </BorderWidth>
          <TextAlign>Right</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>4pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>1</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>15cm</Left>
        <Value>="Page " &amp; Globals!PageNumber</Value>
      </Textbox>
      <Textbox Name="textbox57">
        <Top>0.25cm</Top>
        <Width>15cm</Width>
        <Style>
          <BorderStyle>
            <Top>Solid</Top>
          </BorderStyle>
          <BorderWidth>
            <Default>2pt</Default>
          </BorderWidth>
          <TextAlign>Left</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>4pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <CanGrow>true</CanGrow>
        <Value>="Printed on " + Day(Now()).ToString + " " + MonthName(Month(Now())) + " " + Year(Now()).ToString</Value>
      </Textbox>
    </ReportItems>
    <Height>0.95cm</Height>
    <PrintOnLastPage>true</PrintOnLastPage>
  </PageFooter>
  <TopMargin>0.5cm</TopMargin>
  <PageHeight>29.7cm</PageHeight>
</Report>