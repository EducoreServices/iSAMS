<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="iSAMS">
      <rd:DataSourceID>ef259168-62c9-4696-a37a-e31f433365dc</rd:DataSourceID>
      <DataSourceReference>iSAMS</DataSourceReference>
    </DataSource>
  </DataSources>
  <InteractiveHeight>11in</InteractiveHeight>
  <ReportParameters>
    <ReportParameter Name="MarkbookID">
      <DataType>String</DataType>
      <Prompt>MarkbookID</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtSchoolID">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <Prompt>txtSchoolID</Prompt>
    </ReportParameter>
    <ReportParameter Name="intNCYear">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <Prompt>intNCYear</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtHouse">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <Prompt>txtHouse</Prompt>
    </ReportParameter>
    <ReportParameter Name="txtForm">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <Prompt>txtForm</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>8.5in</InteractiveWidth>
  <rd:GridSpacing>0.25cm</rd:GridSpacing>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <RightMargin>2.5cm</RightMargin>
  <LeftMargin>2.5cm</LeftMargin>
  <BottomMargin>2.5cm</BottomMargin>
  <rd:ReportID>9ebdf5ea-bbf3-4c4d-b9d0-c22b49af75db</rd:ReportID>
  <PageWidth>21cm</PageWidth>
  <DataSets>
    <DataSet Name="iSAMS">
      <Fields>
        <Field Name="TblMarkBooksMarkBookID">
          <DataField>TblMarkBooksMarkBookID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="txtName">
          <DataField>txtName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtDescription">
          <DataField>txtDescription</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TblMarkBooksTestID">
          <DataField>TblMarkBooksTestID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Expr1">
          <DataField>Expr1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtSchoolID">
          <DataField>txtSchoolID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="intTest">
          <DataField>intTest</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="txtMark">
          <DataField>txtMark</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtForename">
          <DataField>txtForename</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="txtSurname">
          <DataField>txtSurname</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="dteSubmitDateTime">
          <DataField>dteSubmitDateTime</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="intTotalMark">
          <DataField>intTotalMark</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="TestPercentage">
          <DataField>TestPercentage</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>iSAMS</DataSourceName>
        <CommandText>SELECT        TblMarkBooksMarkBook.TblMarkBooksMarkBookID, TblMarkBooksMarkBook.txtName, TblMarkBooksMarkBook.txtDescription, 
                         TblMarkBooksTest.TblMarkBooksTestID, TblMarkBooksTest.txtName AS Expr1, TblMarkBooksEntry.txtSchoolID, TblMarkBooksEntry.intTest, 
                         TblMarkBooksMark.txtMark, TblPupilManagementPupils.txtForename, TblPupilManagementPupils.txtSurname, TblMarkBooksMark.dteSubmitDateTime, 
                         (CASE WHEN TblMarkBooksTest.intTotalMark IS NULL THEN - 1 ELSE TblMarkBooksTest.intTotalMark END) AS intTotalMark, 
                         (CASE ISNUMERIC(TblMarkBooksMark.txtMark) WHEN 0 THEN NULL ELSE (CAST(TblMarkBooksMark.txtMark AS decimal) 
                         / TblMarkBooksTest.intTotalMark * 100) END) AS TestPercentage
FROM            TblMarkBooksEntry INNER JOIN
                         TblMarkBooksMark ON TblMarkBooksEntry.TblMarkBooksEntryID = TblMarkBooksMark.intEntry INNER JOIN
                         TblMarkBooksTest ON TblMarkBooksEntry.intTest = TblMarkBooksTest.TblMarkBooksTestID INNER JOIN
                         TblMarkBooksMarkBook ON TblMarkBooksTest.intMarkBook = TblMarkBooksMarkBook.TblMarkBooksMarkBookID INNER JOIN
                         TblPupilManagementPupils ON TblMarkBooksEntry.txtSchoolID = TblPupilManagementPupils.txtSchoolID
WHERE        (TblMarkBooksMarkBook.TblMarkBooksMarkBookID = @MarkBookID)
AND ((TblPupilManagementPupils.txtSchoolID = @txtSchoolID) OR (@txtSchoolID IS NULL))
AND ((TblPupilManagementPupils.intNCYear = @intNCYear) OR (@intNCYear IS NULL))
AND ((TblPupilManagementPupils.txtAcademicHouse = @txtHouse) OR (@txtHouse IS NULL))
AND ((TblPupilManagementPupils.txtForm = @txtForm) OR (@txtForm IS NULL))</CommandText>
        <QueryParameters>
          <QueryParameter Name="@MarkBookID">
            <Value>=Parameters!MarkbookID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtSchoolID">
            <Value>=Parameters!txtSchoolID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@intNCYear">
            <Value>=Parameters!intNCYear.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtHouse">
            <Value>=Parameters!txtHouse.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@txtForm">
            <Value>=Parameters!txtForm.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
  </DataSets>
  <Width>12cm</Width>
  <Body>
    <ColumnSpacing>1cm</ColumnSpacing>
    <ReportItems>
      <List Name="List1">
        <Sorting>
          <SortBy>
            <SortExpression>=Fields!txtSurname.Value</SortExpression>
            <Direction>Ascending</Direction>
          </SortBy>
        </Sorting>
        <ZIndex>1</ZIndex>
        <DataSetName>iSAMS</DataSetName>
        <ReportItems>
          <Table Name="table2">
            <TableGroups>
              <TableGroup>
                <Grouping Name="table2_Group2">
                  <GroupExpressions>
                    <GroupExpression>=Fields!intTest.Value</GroupExpression>
                  </GroupExpressions>
                </Grouping>
                <Header>
                  <TableRows>
                    <TableRow>
                      <TableCells>
                        <TableCell>
                          <ReportItems>
                            <Textbox Name="textbox20">
                              <Style>
                                <BorderStyle>
                                  <Default>Solid</Default>
                                  <Top>Solid</Top>
                                </BorderStyle>
                                <FontSize>8pt</FontSize>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                              <ZIndex>3</ZIndex>
                              <CanGrow>true</CanGrow>
                              <Value>=Fields!Expr1.Value</Value>
                            </Textbox>
                          </ReportItems>
                        </TableCell>
                        <TableCell>
                          <ReportItems>
                            <Textbox Name="textbox9">
                              <Style>
                                <BorderStyle>
                                  <Default>Solid</Default>
                                  <Top>Solid</Top>
                                </BorderStyle>
                                <FontSize>8pt</FontSize>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                              <ZIndex>2</ZIndex>
                              <CanGrow>true</CanGrow>
                              <Value>=iif(Fields!intTotalMark.Value &lt;&gt; -1, Fields!txtMark.Value.ToString + " ("+Fields!intTotalMark.Value.ToString +")", Fields!txtMark.Value.ToString)</Value>
                            </Textbox>
                          </ReportItems>
                        </TableCell>
                        <TableCell>
                          <ReportItems>
                            <Textbox Name="dteSubmitDateTime">
                              <rd:DefaultName>dteSubmitDateTime</rd:DefaultName>
                              <Style>
                                <BorderStyle>
                                  <Default>Solid</Default>
                                  <Top>Solid</Top>
                                </BorderStyle>
                                <FontSize>8pt</FontSize>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                              <ZIndex>1</ZIndex>
                              <CanGrow>true</CanGrow>
                              <Value>= Day(First(Fields!dteSubmitDateTime.Value)).ToString + " "
+ MonthName(Month(First(Fields!dteSubmitDateTime.Value))).ToString + " "
+ Year(First(Fields!dteSubmitDateTime.Value)).ToString</Value>
                            </Textbox>
                          </ReportItems>
                        </TableCell>
                      </TableCells>
                      <Height>0.63492cm</Height>
                    </TableRow>
                  </TableRows>
                </Header>
              </TableGroup>
              <TableGroup>
                <Grouping Name="table2_Group3">
                  <GroupExpressions>
                    <GroupExpression>=Fields!intTest.Value</GroupExpression>
                  </GroupExpressions>
                </Grouping>
              </TableGroup>
              <TableGroup>
                <Grouping Name="table2_Group1">
                  <GroupExpressions>
                    <GroupExpression>=Fields!intTest.Value</GroupExpression>
                  </GroupExpressions>
                </Grouping>
                <Sorting>
                  <SortBy>
                    <SortExpression>=Fields!Expr1.Value</SortExpression>
                    <Direction>Ascending</Direction>
                  </SortBy>
                </Sorting>
              </TableGroup>
            </TableGroups>
            <Header>
              <TableRows>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ColSpan>2</ColSpan>
                      <ReportItems>
                        <Textbox Name="txtName">
                          <rd:DefaultName>txtName</rd:DefaultName>
                          <Style>
                            <FontWeight>700</FontWeight>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>11</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!txtName.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox3">
                          <rd:DefaultName>textbox3</rd:DefaultName>
                          <Style>
                            <FontSize>9pt</FontSize>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>10</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.5cm</Height>
                </TableRow>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ColSpan>3</ColSpan>
                      <ReportItems>
                        <Textbox Name="txtDescription">
                          <rd:DefaultName>txtDescription</rd:DefaultName>
                          <Style>
                            <FontSize>8pt</FontSize>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>9</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!txtDescription.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.5cm</Height>
                </TableRow>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ColSpan>3</ColSpan>
                      <ReportItems>
                        <Textbox Name="txtSurname">
                          <rd:DefaultName>txtSurname</rd:DefaultName>
                          <Style>
                            <BorderStyle>
                              <Default>Solid</Default>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>8</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!txtSurname.Value.ToString +", "+Fields!txtForename.Value.ToString</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.5cm</Height>
                </TableRow>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ColSpan>3</ColSpan>
                      <ReportItems>
                        <Table Name="table3">
                          <ZIndex>7</ZIndex>
                          <Style>
                            <BorderStyle>
                              <Default>Solid</Default>
                            </BorderStyle>
                          </Style>
                          <Header>
                            <TableRows>
                              <TableRow>
                                <TableCells>
                                  <TableCell>
                                    <ReportItems>
                                      <Textbox Name="textbox6">
                                        <rd:DefaultName>textbox6</rd:DefaultName>
                                        <Style>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                          <PaddingTop>2pt</PaddingTop>
                                          <PaddingBottom>2pt</PaddingBottom>
                                        </Style>
                                        <ZIndex>3</ZIndex>
                                        <CanGrow>true</CanGrow>
                                        <Value />
                                      </Textbox>
                                    </ReportItems>
                                  </TableCell>
                                  <TableCell>
                                    <ReportItems>
                                      <Textbox Name="textbox10">
                                        <rd:DefaultName>textbox10</rd:DefaultName>
                                        <Style>
                                          <FontSize>8pt</FontSize>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                          <PaddingTop>2pt</PaddingTop>
                                          <PaddingBottom>2pt</PaddingBottom>
                                        </Style>
                                        <ZIndex>2</ZIndex>
                                        <CanGrow>true</CanGrow>
                                        <Value>="Min: " + round(Min(Fields!TestPercentage.Value),2).ToString + "%"</Value>
                                      </Textbox>
                                    </ReportItems>
                                  </TableCell>
                                  <TableCell>
                                    <ReportItems>
                                      <Textbox Name="textbox7">
                                        <rd:DefaultName>textbox7</rd:DefaultName>
                                        <Style>
                                          <FontSize>8pt</FontSize>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                          <PaddingTop>2pt</PaddingTop>
                                          <PaddingBottom>2pt</PaddingBottom>
                                        </Style>
                                        <ZIndex>1</ZIndex>
                                        <CanGrow>true</CanGrow>
                                        <Value>="Max: " + round(Max(Fields!TestPercentage.Value),2).ToString + "%"</Value>
                                      </Textbox>
                                    </ReportItems>
                                  </TableCell>
                                  <TableCell>
                                    <ReportItems>
                                      <Textbox Name="textbox11">
                                        <rd:DefaultName>textbox11</rd:DefaultName>
                                        <Style>
                                          <FontSize>8pt</FontSize>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                          <PaddingTop>2pt</PaddingTop>
                                          <PaddingBottom>2pt</PaddingBottom>
                                        </Style>
                                        <CanGrow>true</CanGrow>
                                        <Value>="Avg: " + round(SUM(Fields!TestPercentage.Value) / COUNT(Fields!TestPercentage.Value),2).ToString + "%"</Value>
                                      </Textbox>
                                    </ReportItems>
                                  </TableCell>
                                </TableCells>
                                <Height>0.62698cm</Height>
                              </TableRow>
                            </TableRows>
                          </Header>
                          <TableColumns>
                            <TableColumn>
                              <Width>5.25cm</Width>
                            </TableColumn>
                            <TableColumn>
                              <Width>2.2379cm</Width>
                            </TableColumn>
                            <TableColumn>
                              <Width>2.25cm</Width>
                            </TableColumn>
                            <TableColumn>
                              <Width>2.2621cm</Width>
                            </TableColumn>
                          </TableColumns>
                        </Table>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.63492cm</Height>
                </TableRow>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox12">
                          <rd:DefaultName>textbox12</rd:DefaultName>
                          <Style>
                            <BorderStyle>
                              <Default>Solid</Default>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>6</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Test</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox16">
                          <Style>
                            <BorderStyle>
                              <Default>Solid</Default>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>5</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Mark (Total Mark)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox14">
                          <rd:DefaultName>textbox14</rd:DefaultName>
                          <Style>
                            <BorderStyle>
                              <Default>Solid</Default>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <ZIndex>4</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Date</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.63492cm</Height>
                </TableRow>
              </TableRows>
            </Header>
            <TableColumns>
              <TableColumn>
                <Width>4cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>4cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>4cm</Width>
              </TableColumn>
            </TableColumns>
            <Footer>
              <TableRows>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ColSpan>3</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox8">
                          <Style>
                            <Color>DarkBlue</Color>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                          <CanGrow>true</CanGrow>
                          <Value>=Now</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.5cm</Height>
                </TableRow>
              </TableRows>
            </Footer>
          </Table>
        </ReportItems>
        <Top>0.75cm</Top>
        <Grouping Name="list1_txtName">
          <GroupExpressions>
            <GroupExpression>=Fields!txtSchoolID.Value</GroupExpression>
          </GroupExpressions>
          <PageBreakAtEnd>true</PageBreakAtEnd>
        </Grouping>
      </List>
      <Table Name="table1">
        <Visibility>
          <Hidden>=iif(Fields!TblMarkBooksMarkBookID.Value is nothing, false, true)</Hidden>
        </Visibility>
        <Header>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ColSpan>3</ColSpan>
                  <ReportItems>
                    <Textbox Name="textbox2">
                      <rd:DefaultName>textbox2</rd:DefaultName>
                      <Style>
                        <FontWeight>700</FontWeight>
                        <TextAlign>Center</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>No results for this markbook</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.63492cm</Height>
            </TableRow>
          </TableRows>
        </Header>
        <TableColumns>
          <TableColumn>
            <Width>4cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>4cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>4cm</Width>
          </TableColumn>
        </TableColumns>
        <Height>0.63492cm</Height>
      </Table>
    </ReportItems>
    <Height>4.65476cm</Height>
  </Body>
  <Language>en-US</Language>
  <TopMargin>2.5cm</TopMargin>
  <PageHeight>29.7cm</PageHeight>
</Report>